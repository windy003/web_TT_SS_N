(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"0d9dbdda7ec2e7c9119f":function(e,t,i){"use strict";i.d(t,"a",(function(){return tt}));var n=function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,o,a=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)r.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return r}function a(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}var r,s,c,l,h=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var i=this;e&&t&&"function"==typeof t&&this.on(e,(function n(o){t(o),i.off(e,n)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var i=this._hooks[e].indexOf(t);-1!==i&&this._hooks[e].splice(i,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t,i){if(i){if(!e)return;-1!==this._cache.indexOf(i)?this._emit(e,t):(this._hooksCache.hasOwnProperty(i)||(this._hooksCache[i]={}),this._hooksCache[i].hasOwnProperty(e)||(this._hooksCache[i][e]=[]),this._hooksCache[i][e].push(t))}else this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&a(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),u=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},p=function(e){return Array.isArray(e)},d=(r=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return r+=1}),f=function(e){return function(e,t,i){if("string"==typeof e&&"number"==typeof i){var n,o=[];i=i<=25?i:i%25;var a=String.fromCharCode(i+97);n=e.split(a);for(var r=0;r<n.length;r++){var s=parseInt(n[r],i);s=1*s^64;var c=String.fromCharCode(s);o.push(c)}return o.join("")}}(e,0,25)},g=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},m=function(e,t,i){var n=document.createElement("script");n.src=e,n.onerror=function(){i(e)},n.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(n)},v=function(){var e=0;return["hidden","msHidden","webkitHidden"].forEach((function(t){void 0!==document[t]&&(e=1)})),e},_=function(e){var t=document.createElement("a");return t.href=e,t},z=function(e){var t={};try{var i=_(e).search;if(!i)return t;(i=i.slice(1)).split("&").forEach((function(e){var i,n,o=e.split("=");o.length&&(i=o[0],n=o[1]);try{t[i]=decodeURIComponent(void 0===n?"":n)}catch(e){t[i]=n}}))}catch(e){}return t},y=function(e){for(var t=0,i=0,n=(e+="").length,o=0;o<n;o++)((t=31*t+e.charCodeAt(i++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t},b=(function(e,t){var i;i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function o(){}function a(t,i,a){if("undefined"!=typeof document){"number"==typeof(a=e({path:"/"},o.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var r=JSON.stringify(i);/^[\{\[]/.test(r)&&(i=r)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in a)a[c]&&(s+="; "+c,!0!==a[c]&&(s+="="+a[c].split(";")[0]));return document.cookie=t+"="+i+s}}function r(e,i){if("undefined"!=typeof document){for(var o={},a=document.cookie?document.cookie.split("; "):[],r=0;r<a.length;r++){var s=a[r].split("="),c=s.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(n.read||n)(c,l)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(o[l]=c,e===l)break}catch(e){}}return e?o[e]:o}}return o.set=a,o.get=function(e){return r(e,!1)},o.getJSON=function(e){return r(e,!0)},o.remove=function(t,i){a(t,"",e(i,{expires:-1}))},o.defaults={},o.withConverter=i,o}((function(){}))},e.exports=i()}(s={exports:{}}),s.exports),E=function(e,t){try{return e?b.get(e,{domain:t||document.domain}):b.get()}catch(e){return""}},w=function(e,t,i,n){try{var o=n||document.domain,a=+new Date+(i||6048e5);b.set(e,t,{expires:new Date(a),path:"/",domain:o})}catch(e){}},S=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return E(e,t)},e.prototype.setCookie=function(e,t,i,n){w(e,t,i,n)},e}(),k={getItem:function(e){try{var t=localStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||{}}catch(e){}return{}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return E(e,t)},setCookie:function(e,t,i,n){w(e,t,i,n)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(n){return!1}}()},T={getItem:function(e){try{var t=sessionStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||{}}catch(e){}return{}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return E(e,t)},setCookie:function(e,t,i,n){w(e,t,i,n)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(n){return!1}}()},A=function(){function e(e,t){this._storage=t&&"session"===t?T:!e&&k.isSupportLS?k:new S}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,i,n){this._storage.setCookie(e,t,i,n)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),D=function(){function e(e,t,i){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=i}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,i=document.referrer,n=i?_(i).hostname:"",o=z(window.location.href),a=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(e,t,i,n){var o=new A(!1),a=new A(!1,"session"),r=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},l=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],h={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var u=!1;for(var p in h)h[p]&&(-1!==l.indexOf(p)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[p]=h[p]):c[p]=h[p],u=!0);if(u)a.setItem(s,"1"),o.setCookie(r,JSON.stringify(c),n,i);else{var d=o.getCookie(r,i);d&&(c=JSON.parse(d))}a.getItem(s)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return h}return c}(this.appid,o,this.domain,this.cookie_expire);var r=this.browser(),s=this.os();return{browser:r.browser,browser_version:r.browser_version,platform:a,os_name:s.os_name,os_version:s.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(s.os_name),language:t,referrer:i,referrer_host:n,utm:this.utm,latest_data:this.last(i,n)}},e.prototype.last=function(e,t){var i="",n="",o="",a=location.hostname,r=!1;if(e&&t&&a!==t){i=e,n=t,r=!0;var s=z(e);s.keyword&&(o=s.keyword)}return{$latest_referrer:i,$latest_referrer_host:n,$latest_search_keyword:o,isLast:r}},e.prototype.browser=function(){var e,t,i="",n=""+parseFloat(this.appVersion),o=this.userAgent;return-1!==o.indexOf("Edge")||-1!==o.indexOf("Edg")?(i="Microsoft Edge",-1!==o.indexOf("Edge")?(e=o.indexOf("Edge"),n=o.substring(e+5)):(e=o.indexOf("Edg"),n=o.substring(e+4))):-1!==(e=o.indexOf("MSIE"))?(i="Microsoft Internet Explorer",n=o.substring(e+5)):-1!==(e=o.indexOf("Lark"))?(i="Lark",n=o.substring(e+5,e+11)):-1!==(e=o.indexOf("MetaSr"))?(i="sougoubrowser",n=o.substring(e+7,e+10)):-1!==o.indexOf("MQQBrowser")||-1!==o.indexOf("QQBrowser")?(i="qqbrowser",-1!==o.indexOf("MQQBrowser")?(e=o.indexOf("MQQBrowser"),n=o.substring(e+11,e+15)):-1!==o.indexOf("QQBrowser")&&(e=o.indexOf("QQBrowser"),n=o.substring(e+10,e+17))):-1!==o.indexOf("Chrome")?-1!==(e=o.indexOf("MicroMessenger"))?(i="weixin",n=o.substring(e+15,e+20)):-1!==(e=o.indexOf("360"))?(i="360browser",n=o.substring(o.indexOf("Chrome")+7)):-1!==o.indexOf("baidubrowser")||-1!==o.indexOf("BIDUBrowser")?(-1!==o.indexOf("baidubrowser")?(e=o.indexOf("baidubrowser"),n=o.substring(e+13,e+16)):-1!==o.indexOf("BIDUBrowser")&&(e=o.indexOf("BIDUBrowser"),n=o.substring(e+12,e+15)),i="baidubrowser"):-1!==(e=o.indexOf("xiaomi"))?-1!==o.indexOf("openlanguagexiaomi")?(i="openlanguage xiaomi",n=o.substring(e+7,e+13)):(i="xiaomi",n=o.substring(e-7,e-1)):-1!==(e=o.indexOf("TTWebView"))?(i="TTWebView",n=o.substring(e+10,e+23)):(-1!==(e=o.indexOf("Chrome"))||-1!==(e=o.indexOf("Chrome")))&&(i="Chrome",n=o.substring(e+7)):-1!==o.indexOf("Safari")?-1!==(e=o.indexOf("QQ"))?(i="qqbrowser",n=o.substring(e+10,e+16)):-1!==(e=o.indexOf("Safari"))&&(i="Safari",n=o.substring(e+7),-1!==(e=o.indexOf("Version"))&&(n=o.substring(e+8))):-1!==(e=o.indexOf("Firefox"))?(i="Firefox",n=o.substring(e+8)):-1!==(e=o.indexOf("MicroMessenger"))?(i="weixin",n=o.substring(e+15,e+20)):-1!==(e=o.indexOf("QQ"))&&(i="qqbrowser",n=o.substring(e+3,e+8)),-1!==(t=n.indexOf(";"))&&(n=n.substring(0,t)),-1!==(t=n.indexOf(" "))&&(n=n.substring(0,t)),-1!==(t=n.indexOf(")"))&&(n=n.substring(0,t)),{browser:i,browser_version:n}},e.prototype.os=function(){for(var e="",t="",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"chromeOS",r:/CrOS/},{s:"Linux",r:/(Linux|X11)/},{s:"Sun OS",r:/SunOS/}],n=0;n<i.length;n++){var o=i[n];if(o.r.test(this.userAgent)){"Mac OS X"===(e=o.s)&&this.isNewIpad()&&(e="iOS");break}}var a,r,s=function(e,t){var i=e.exec(t);return i&&i[1]?i[1]:""},c=function(e,t){var i=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return i?i.slice(1)[0]:""};switch(/Windows/.test(e)&&(t=s(/Windows (.*)/,e),e="windows"),e){case"Mac OS X":t=c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":(r=s(/Android ([\.\_\d]+)/,a=this.userAgent))||(r=s(/Android\/([\.\_\d]+)/,a)),t=r,e="android";break;case"iOS":t=this.isNewIpad()?c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios";break;case"chromeOS":var l=this.userAgent.indexOf("x86_64");t=this.userAgent.substring(l+7,l+16)}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e)if(this.isNewIpad())t="iPad";else{var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");t=i.slice(0,n)}}catch(e){return t.trim()}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),C={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},x={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az28z1gz1hz1gz1cz18z1nz1gz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},O="5.1.13",M=f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21"),G=f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21"),I=f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21"),R=f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1c"),N=f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20"),B=function(){function e(e,t){this.collector=e,this.config=t,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=new RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return e.prototype.checkVerify=function(e){var t=this;if(!e||!e.length)return!1;var i=e[0];if(!i)return!1;var n=i.events,o=i.header;if(!n||!n.length)return!1;var a=!0;return n.forEach((function(e){if(!e)return a=!1,void(e.checkEvent="\u4e8b\u4ef6\u5f02\u5e38");t.checkEventName(e.event)||(a=!1,e.checkEvent="\u4e8b\u4ef6\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934"),t.checkEventParams(e.params)||(a=!1,e.checkParams="\u5c5e\u6027\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934")})),this.checkEventParams(o)||(a=!1),a},e.prototype.checkEventName=function(e){return!!e&&this.calculate(e,"event")},e.prototype.checkEventParams=function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(t)),!Object.keys(t).length)return!0;for(var i in t)return!(!this.calculate(i,"params")||"string"==typeof t[i]&&t[i].length>1024);return!0},e.prototype.calculate=function(e,t){return-1!==("event"===t?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(e)||!new RegExp("^\\$").test(e)&&!new RegExp("^__").test(e)||!1},e}();!function(e){e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.UnReady="un-ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.SetSessionId="set-session-id",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.AbTimeout="ab-timeout",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready",e.sessionRecord="session-record",e.SessionRecordStart="session-record-start",e.SessionRecordPause="session-record-pause",e.SessionRecordEnd="session-record-end",e.SessionRecordReport="session-record-report",e.DestoryInstance="destory-instance",e.VisualCollectReady="visual-collect-ready",e.VisualApiReady="visual-api-ready",e.VisualApiUpdate="visual-api-update"}(c||(c={})),function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(l||(l={}));var j=c,P=void 0,U=(new Date).getTimezoneOffset(),V=parseInt(""+-U/60,10),L=60*U,H=function(){function e(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var i=new D(t.app_id,t.cookie_domain||"",t.cookie_expire||7776e6).init();this.eventCheck=new B(e,t);var n="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new A(!1,"session"),this.localStorage=new A(!1,"local"),t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage);var o=this.localStorage.getItem(n);o&&1==o?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(n,"1")),this.envInfo={user:{user_unique_id:P,user_type:P,user_id:P,user_is_auth:P,user_is_login:P,device_id:P,web_id:P,ip_addr_id:P,user_unique_id_type:P},header:{app_id:P,app_name:P,app_install_id:P,install_id:P,app_package:P,app_channel:P,app_version:P,ab_version:P,os_name:i.os_name,os_version:i.os_version,device_model:i.device_model,ab_client:P,traffic_type:P,client_ip:P,device_brand:P,os_api:P,access:P,language:i.language,region:P,app_language:P,app_region:P,creative_id:i.utm.creative_id,ad_id:i.utm.ad_id,campaign_id:i.utm.campaign_id,log_type:P,rnd:P,platform:i.platform,sdk_version:O,sdk_lib:"js",province:P,city:P,timezone:V,tz_offset:L,tz_name:P,sim_region:P,carrier:P,resolution:i.screen_width+"x"+i.screen_height,browser:i.browser,browser_version:i.browser_version,referrer:i.referrer,referrer_host:i.referrer_host,width:i.screen_width,height:i.screen_height,screen_width:i.screen_width,screen_height:i.screen_height,utm_term:i.utm.utm_term,utm_content:i.utm.utm_content,utm_source:i.utm.utm_source,utm_medium:i.utm.utm_medium,utm_campaign:i.utm.utm_campaign,tracer_data:JSON.stringify(i.utm.tracer_data),custom:{},wechat_unionid:P,wechat_openid:P}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(i),this.initDomain(),this.initABData()}return e.prototype.initDomain=function(){var e=this.initConfig.channel_domain;if(e)this.domain=e;else{var t=this.initConfig.channel;this.domain=f(x[t])}},e.prototype.setDomain=function(e){this.domain=e},e.prototype.getDomain=function(){return this.domain},e.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id,t=null;if(this.initConfig.ab_cross){var i=this.localStorage.getCookie(e,this.initConfig.ab_cookie_domain);t=i?JSON.parse(i):null}else t=this.localStorage.getItem(e);this.setAbCache(t)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.clearAbCache=function(){this.ab_version="",this.ab_cache={}},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t="/list";break;case"webid":t="/webid";break;case"tobid":t="/tobid"}var i="";return this.initConfig.caller&&(i="?sdk_version=5.1.13&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+i},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.set=function(e){var t=this;Object.keys(e).forEach((function(i){void 0!==e[i]&&null!==e[i]||t.delete(i);try{t.eventCheck.calculate(i,"config")}catch(n){}if("traffic_type"===i&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[i]),"evtParams"===i)t.evtParams=n({},t.evtParams||{},e.evtParams||{});else if("_staging_flag"===i)t.evtParams=n({},t.evtParams||{},{_staging_flag:e._staging_flag});else if("reportErrorCallback"===i&&"function"==typeof e[i])t.reportErrorCallback=e[i];else{var o="",a="";if(i.indexOf(".")>-1){var r=i.split(".");o=r[0],a=r[1]}o?"user"===o||"header"===o?t.envInfo[o][a]=e[i]:t.envInfo.header.custom[a]=e[i]:Object.hasOwnProperty.call(t.envInfo.user,i)?["user_type","ip_addr_id"].indexOf(i)>-1?t.envInfo.user[i]=e[i]?Number(e[i]):e[i]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(i)>-1?t.envInfo.user[i]=e[i]?String(e[i]):e[i]:["user_is_auth","user_is_login"].indexOf(i)>-1?t.envInfo.user[i]=Boolean(e[i]):"device_id"===i&&(t.envInfo.user[i]=e[i]):Object.hasOwnProperty.call(t.envInfo.header,i)?t.envInfo.header[i]=e[i]:t.envInfo.header.custom[i]=e[i]}}))},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var i=Object.assign(e,t);this.storage.setItem(this.configKey,i)}}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};t&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e}(),q=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog},e.prototype.warn=function(e){this.isLog},e.prototype.error=function(e){this.isLog},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),K=function(){function e(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return e.prototype.checkSpider=function(e){if(!e.enable_spider)return!1;var t=window.navigator.userAgent;if(!t)return!0;var i=!1;return this.spiderBot.forEach((function(e){-1!==t.indexOf(e)&&(i=!0)})),i},e}(),J=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&!!AppLogBridge}catch(e){return!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,i){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){e?t(!0):i(!1)})):i(!1)}catch(e){i(!1)}}))},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e))}catch(e){}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(i){"user_unique_id"===i?t.setUserUniqueId(e[i]):e[i]?t.addHeaderInfo(i,e[i]):t.removeHeaderInfo(i)}))}catch(e){}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57cb\u70b9\u4e0a\u62a5",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){}},e}(),W=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},F=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.storage=new A(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSessionTimeCheck=t.disable_session_check,this.disableSession||(this.setSessionId(),this.collect.on(j.SessionReset,(function(e){i.resetSessionId(e)})),this.collect.on(j.SessionResetTime,(function(){i.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:W(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:W(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.disableSessionTimeCheck||(this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(e){var t={sessionId:e||W(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,t)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:W(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),$=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.eventCheck=new B(e,t),this.cacheStorgae=new A(!0),this.localStorage=new A(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||t.report_time||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=t.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.pageId=W(),this.collect.on(j.Ready,(function(){i.reportAll(!1)})),this.collect.on(j.ConfigDomain,(function(){i.reportUrl=i.configManager.getUrl("event")})),this.collect.on(j.Event,(function(e){i.event(e)})),this.collect.on(j.BeconEvent,(function(e){i.beconEvent(e)})),this.collect.on(j.CleanEvents,(function(){i.reportAll(!1)}));var n=this.linster();this.collect.on(j.DestoryInstance,(function(){n&&n()}))},e.prototype.linster=function(){var e=this,t=function(){e.reportAll(!0)};window.addEventListener("unload",t,!1),g(t);var i=function(){"hidden"===document.visibilityState&&e.reportAll(!0)};return document.addEventListener("visibilitychange",i,!1),function(){window.removeEventListener("unload",t),window.removeEventListener("pagehide",t,!1),window.removeEventListener("beforeunload",t,!1),document.removeEventListener("visibilitychange",i,!1)}},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{var i=a(e,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,i),this.reportTimeout&&clearTimeout(this.reportTimeout),i.length>=this.maxReport)this.report(!1);else{var n=this.reportTime;this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),n)}}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e){var t=a(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.destroy||this.collect.sdkStop||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))},e.prototype.reportBecon=function(){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},e.prototype.report=function(e){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))}},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var i=0;i<e.length;i+=this.eventLimit){var n;n=e.slice(i,i+this.eventLimit);var o=this.split(this.merge(n));this.send(o,t)}else o=this.split(this.merge(e)),this.send(o,t)},e.prototype.handleRefer=function(){var e="";try{if(this.config.spa||this.config.autotrack){var t=this.localStorage.getItem(this.refer_key)||{};e=t.routeChange?t.refer_key:this.configManager.get("referrer")}else e=this.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.merge=function(e,t){var i=this,o=this.configManager.get(),a=o.header,r=o.user;this.config.enable_pageid&&(a.custom.page_id=this.pageId),a.referrer=this.handleRefer(),a.custom=JSON.stringify(a.custom);var s=this.configManager.get("evtParams"),c=this.configManager.get("user_unique_id_type"),h=e.map((function(e){try{Object.keys(s).length&&!t&&(e.params=n({},s,e.params)),c&&(e.params.$user_unique_id_type=c);var o=i.configManager.getAbCache(),a=r[i.config.ab_user_mode]||r.user_unique_id;return o&&o.uuid&&o.uuid===a&&i.configManager.getAbVersion()&&(e.ab_sdk_version=i.configManager.getAbVersion()),e.session_id=i.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(n){return i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:n.message}),e}})),u=JSON.parse(JSON.stringify({events:h,user:r,header:a}));u.local_time=Math.floor(Date.now()/1e3),u.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,u.verbose=1;var p=[];return p.push(u),p},e.prototype.split=function(e){return e.map((function(e){var t=[];return t.push(e),t}))},e.prototype.send=function(e,t){var i=this;e.length&&(this.config.disable_track_event||e.forEach((function(e){try{var n=JSON.parse(JSON.stringify(e));i.config.filter&&(n=i.config.filter(n)),i.collect.eventFilter&&n&&(n=i.collect.eventFilter(n));var o=n||e,a=JSON.parse(JSON.stringify(o));if(i.eventCheck.checkVerify(a),!o.length)return;var r=!0;if(o.forEach((function(e){e.events.length||(r=!1)})),!r)return;i.collect.emit(j.SubmitBefore,o),i.collect.requestManager.useRequest({url:i.reportUrl,data:o,success:function(e,t){e&&0!==e.e?(i.collect.emit(j.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u5931\u8d25",time:Date.now(),data:a,code:e.e,failType:"\u6570\u636e\u5f02\u5e38\u5931\u8d25",status:"fail"})):(i.collect.emit(j.SubmitScuess,{eventData:t,res:e}),i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:a,code:200,status:"success"}))},fail:function(e,t){i.configManager.get("reportErrorCallback")(e,t),i.collect.emit(j.SubmitError,{type:"f_net",eventData:e,errorCode:t}),i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u7f51\u7edc\u5f02\u5e38",time:Date.now(),data:a,code:t,failType:"\u7f51\u7edc\u5f02\u5e38\u5931\u8d25",status:"fail"})},timeout:i.timeout,useBeacon:t,withCredentials:i.enable_ttwebid}),i.collect.emit(j.SubmitAfter,o)}catch(e){i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}})))},e}(),X=function(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}().replace(/-/g,"").slice(0,19)},Q=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new A(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(j.ConfigUuid,(function(e){i.setUuid(e)})),this.collect.on(j.ConfigWebId,(function(e){i.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var t=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=t&&"string"==typeof t?JSON.parse(t):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(j.CustomWebId,(function(){e.tokenReady=!0,e.collect.emit(j.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:X(),user_unique_id:this.configManager.get("user_unique_id")||X()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram")){var t=z(window.location.href);return!(!t||!t.Web_ID||(this.complete({web_id:""+t.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+t.Web_ID}),0))}return!1},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),i={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77WEBID\u8bf7\u6c42",logType:"fetch",level:"info",time:Date.now(),data:i}),this.collect.requestManager.useRequest({url:t,data:i,success:function(t){var i;if(t&&0===t.e)i=t.web_id,e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u6210\u529f",logType:"fetch",level:"info",time:Date.now(),data:t});else{var n=X();i=n,e.collect.configManager.set({localWebId:n}),e.collect.emit(j.TokenError),e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u8fd4\u56de\u503c\u5f02\u5e38",logType:"fetch",level:"warn",time:Date.now(),data:t}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")}e.complete({web_id:e.configManager.get("web_id")||i,user_unique_id:e.configManager.get("user_unique_id")||i})},fail:function(){var t=X();e.complete({web_id:e.configManager.get("web_id")||t,user_unique_id:e.configManager.get("user_unique_id")||t}),e.collect.configManager.set({localWebId:t}),e.collect.emit(j.TokenError),e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")},timeout:3e5})},e.prototype.complete=function(e){var t=e.web_id,i=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:i}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(j.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",i=this.configManager.get("user_unique_id");(i||t)&&this.configManager.set({user_unique_id:i||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(j.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),i=this.configManager.get("user_unique_id"),n=this.cacheToken&&this.cacheToken.user_unique_id;if(t===i&&t===n)return;this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(j.TokenChange,"uuid"),this.collect.emit(j.SessionReset)}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&this.configManager.get("user_unique_id")!==this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(j.TokenReset,"uuid"))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),i=this.configManager.get("user_unique_id");i&&i!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(j.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(j.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this;return new Promise((function(t){e.collect.requestManager.useRequest({url:e.configManager.getUrl("tobid"),data:{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},success:function(e){e&&0===e.e?t(e.tobid):t("")},fail:function(){t("")},time:3e4,withCredentials:e.enable_ttwebid})}))},e}(),Y=function(){function e(e,t){this.collector=e,this.config=t,this.requestType=t.request_type||"xhr",this.supportBeacon=!(!window.navigator||!window.navigator.sendBeacon),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},this.customHeader=t.custom_request_header||{}}return e.prototype.useFetch=function(e){var t=e.url,i=e.data,n=e.method,o=e.success,a=e.fail,r={"Content-Type":"application/json; charset=utf-8"};if(Object.keys(this.customHeader).length)for(var s in this.customHeader)r[s]=this.customHeader[s];window.fetch?fetch(t,{method:n||"POST",headers:r,body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){o&&o(e)})).catch((function(e){a&&a(i,e)})):(this.requestType="xhr",this.useRequest({url:t,data:i,method:n,success:o,fail:a}))},e.prototype.useBeacon=function(e){var t=e.url,i=e.data,n=e.success,o=e.fail;window.navigator.sendBeacon(t,JSON.stringify(i))?n&&n():o&&o(i,this.errorCode.BEACON_FALSE)},e.prototype.useRequest=function(e){var t=this,i=e.url,n=e.data,o=e.method,a=e.success,r=e.fail,s=e.timeout,c=e.useBeacon,l=e.withCredentials,h=e.app_key,u=e.forceXhr;if(c&&this.supportBeacon)this.useBeacon({url:i,data:n,method:o,success:a,fail:r});else if("fetch"!==this.requestType||u)try{var p=new XMLHttpRequest,d=o||"POST";if(p.open(d,""+i,!0),p.setRequestHeader("Content-Type","application/json; charset=utf-8"),h&&p.setRequestHeader("X-MCS-AppKey",""+h),Object.keys(this.customHeader).length)for(var f in this.customHeader)p.setRequestHeader(f,this.customHeader[f]);l&&(p.withCredentials=!0),s&&(p.timeout=s,p.ontimeout=function(){r&&r(n,t.errorCode.TIMEOUT)}),p.onload=function(){if(a){var e=null;if(p.responseText){try{e=JSON.parse(p.responseText)}catch(t){e={}}a(e,n)}}},p.onerror=function(){p.abort(),r&&r(n,t.errorCode.XHR_ON)},p.send(JSON.stringify(n))}catch(e){}else this.useFetch({url:i,data:n,method:o,success:a,fail:r})},e}(),Z=function(){function e(e,t){if(this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,this.eventVerifyReady=!1,t.enable_debug){var i=e.adapters.storage;this.collect=e,this.config=t,this.app_id=t.app_id,this.cacheStorgae=new i(!1,"session"),this.eventVerifyInfo=[],this.sdk_type=O.includes("tob")?"tob":"inner",this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],this.load()}}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){},t.onload=function(){},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){}},e.prototype.parseUrl=function(){var e={};try{var t=window.location.href.split("?")[1].split("&");t.length&&t.forEach((function(t){var i=t.split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}))}catch(e){}return e},e.prototype.load=function(){return e=this,void 0,i=function(){var e,t;return function(e,t){var i,n,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),(e=this.parseUrl()).open_devtool_web&&e.app_id){if(parseInt(e.app_id)!==this.app_id)return[2]}else if(!this.getStorage())return[2];return this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool(),[4,this.fetchEventInfo()];case 1:return t=i.sent(),this.sendData("devtool:web:verify",t.verifyStatus),this.eventVerifyInfo=t.data,[3,3];case 2:return i.sent(),[3,3];case 3:return[2]}}))},new((t=void 0)||(t=Promise))((function(n,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){e.done?n(e.value):new t((function(t){t(e.value)})).then(a,r)}s((i=i.apply(e,[])).next())}));var e,t,i},e.prototype.getStorage=function(){var e=this.cacheStorgae.getItem("__applog_devtool_web");return e&&parseInt(e)===this.app_id},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web",this.app_id)},e.prototype.loadDevTool=function(){this.loadScript("https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/devtool/debug-web.0.0.2.js")},e.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"\u57fa\u672c\u4fe1\u606f",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,"\u4e0a\u62a5\u57df\u540d":this.collect.configManager.getDomain(),"SDK\u7248\u672c":O,"SDK\u5f15\u5165\u65b9\u5f0f":"npm"}},{title:"\u7528\u6237\u4fe1\u606f",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"\u70b9\u51fb\u83b7\u53d6SSID"}},{title:"\u516c\u5171\u53c2\u6570\u4fe1\u606f",type:2,infoName:{"\u6d4f\u89c8\u5668":this.collect.configManager.get("browser"),"\u6d4f\u89c8\u5668\u7248\u672c":this.collect.configManager.get("browser_version"),"\u5e73\u53f0":this.collect.configManager.get("platform"),"\u8bbe\u5907\u578b\u53f7":this.collect.configManager.get("device_model"),"\u64cd\u4f5c\u7cfb\u7edf":this.collect.configManager.get("os_name"),"\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c":this.collect.configManager.get("os_version"),"\u5c4f\u5e55\u5206\u8fa8\u7387":this.collect.configManager.get("resolution"),"\u6765\u6e90":this.collect.configManager.get("referrer"),"\u81ea\u5b9a\u4e49\u4fe1\u606f":""}},{title:"\u914d\u7f6e\u4fe1\u606f",type:3,infoName:{"\u5168\u57cb\u70b9":!!this.config.autotrack,"\u505c\u7559\u65f6\u957f":!!this.config.enable_stay_duration}},{title:"A/B\u914d\u7f6e\u4fe1\u606f",type:4,infoName:{"A/B\u5b9e\u9a8c":!!this.config.enable_ab_test}},{title:"\u5ba2\u6237\u7aef\u4fe1\u606f",type:3,infoName:{"\u6253\u901a\u5f00\u5173":!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(j.Ready,(function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName["\u81ea\u5b9a\u4e49\u4fe1\u606f"]=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B\u57df\u540d"]=e.config.ab_channel_domain||f(C[e.config.channel]),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName["\u662f\u5426\u6253\u901a"]=!!e.collect.bridgeReport)}))},e.prototype.loadHook=function(){var e=this;this.collect.stop(),this.collect.on(l.DEBUGGER_MESSAGE,(function(t){switch(t.type){case l.DEBUGGER_MESSAGE_SDK:var i={time:t.time,type:t.logType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(i.desc={content:JSON.stringify(t.data)}),e.updateLog(i),t.secType&&"AB"===t.secType?(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()):"USER"===t.secType&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),void e.updateInfo();case l.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var n=t.data[0],o=n.events,a=n.header;if(a.custom=JSON.parse(a.custom),!o.length)return;o.forEach((function(i){i.checkShow=!0,i.searchShow=!0,i.type=-1!==e.filterEvent.indexOf(i.event)?"sdk":"cus",i.type=e.collect.bridgeReport?"bridge":i.type,i.params=JSON.parse(i.params),"fail"===t.status&&(i.info={message:"code: "+t.code+"\uff0c msg: "+t.failType},i.failType=t.failType);var n=!1,o=!1,a=[];e.eventVerifyInfo&&e.eventVerifyInfo.length&&(e.eventVerifyInfo.forEach((function(e){e.eventStatus=!1})),e.eventVerifyInfo.forEach((function(t){i.event===t.name&&(o=!0,n=!0,i.verifyStatus=t.status,Object.keys(i.params).forEach((function(n){if("event_index"!==n){var r={};r.paramsKey=n,r.paramsKeyValue=i.params[""+n],r.paramsStatus=!1,r.paramsStatusInfo="\u5c5e\u6027\u672a\u5f55\u5165",t.params.forEach((function(t){n===t.name&&(t.checked=!0,typeof i.params[""+n]!==e.formatParamsType(t.value_type)?r.paramsStatusInfo="\u5c5e\u6027\u7c7b\u578b\u9519\u8bef\uff0c\u5e94\u4e3a"+e.formatParamsType(t.value_type):(r.paramsStatus=!0,r.paramsStatusInfo=""))})),a.push(r),r.paramsStatusInfo&&(o=!1)}})),t.params.forEach((function(e){e.checked||(o=!1,a.push({paramsKey:e.name,paramsStatus:!1,paramsStatusInfo:"\u7f3a\u5c11\u5c5e\u6027"+e.name}))})))}))),i.reportStatus="success"===t.status,i.paramsInfo=a,i.eventStatus=o&&"success"===t.status,i.eventRecord=n})),e.updateEvent(n)}return}}))},e.prototype.formatParamsType=function(e){switch(e){case 0:return"string";case 1:case 2:return"number";case 3:return"boolean"}},e.prototype.fetchEventInfo=function(){var e=this;try{return new Promise((function(t){var i=f("1fz22z22z1nz21z4mz4bz4bz18z1nz1nz1jz1mz1ez1fz1mz1kz1cz4az19z27z22z1cz1bz18z1lz1az1cz4az1lz1cz22z4bz18z1nz1nz1jz1mz1ez1bz1cz24z22z1mz1mz1jz21z4bz1mz1nz1cz1lz18z1nz1gz4bz24z4dz4bz18z1nz1nz16z1jz1mz1ez16z1kz1cz22z18")+"?app_id="+e.app_id+"&t="+e.sdk_type+"&nc=false";e.collect.requestManager.useRequest({url:i,method:"GET",success:function(i){e.eventVerifyReady=!0,e.collect.reStart(),t({data:i.data,verifyStatus:!0})},fail:function(){e.eventVerifyReady=!0,e.collect.reStart(),t({data:[],verifyStatus:!1})},timeout:3e3})}))}catch(e){return{data:[],verifyStatus:!1}}},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",(function(t){if(t.origin===location.origin){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event,appid:e.app_id}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken((function(t){e.info[1].infoName.ssid=t.tobid,e.updateInfo()})),t&&t.data&&t.data.type}}))},e.prototype.sendData=function(e,t){try{var i={type:e,payload:t};(window.opener||window.parent).postMessage(i,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady||this.eventVerifyReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.appendChild(document.createTextNode("#debugger-applog-web {\n      position: fixed;\n      width: 50px;\n      height: 50px;\n      background-image: url('https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/devtool/applog.png');;\n      bottom: 5%;\n      right: 10%;\n      cursor: pointer;\n      z-index:100;\n      background-size: 50px;\n    }")),e.appendChild(t);var i=document.createElement("div");i.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web"></div>';var n=document.createElement("div");n.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(i),document.getElementsByTagName("body")[0].appendChild(n),document.getElementById("debugger-applog-web").addEventListener("click",(function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)}))},e}(),ee={autotrack:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4az4dz4bz1nz1jz23z1ez1gz1lz4bz18z23z22z1mz22z20z18z1az1iz4az1hz21"),sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4az4dz4bz1nz1jz23z1ez1gz1lz4bz18z19z4az1hz21"),sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4az4dz4bz1nz1jz23z1ez1gz1lz4bz21z22z18z27z4az1hz21"),sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4az4dz4bz1nz1jz23z1ez1gz1lz4bz20z1mz23z22z1cz4az1hz21"),sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4az4dz4bz1nz1jz23z1ez1gz1lz4bz1az1cz1nz4az1hz21"),sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4az4dz4bz1nz1jz23z1ez1gz1lz4bz22z20z18z1az1cz20z4az1hz21"),sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},retry:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4az4dz4bz1nz1jz23z1ez1gz1lz4bz20z1cz22z20z27z4az1hz21"),sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/retry.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/retry.js"},object:"LogRetry"},visual:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4az4dz4bz1nz1jz23z1ez1gz1lz4bz24z1gz21z23z18z1jz4az1hz21"),sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},te=["ab","autotrack","Stay","store","et","profile","cep","heartbeat","monitor","route","tracer"],ie=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.sdkStop=!1,this.name=e,this.hook=new h,this.remotePlugin=new Map,this.Types=j,this.adapters.storage=A,this.loadType="full"}return e.usePlugin=function(t,i,n){if(i){for(var o=!1,a=0,r=e.plugins.length;a<r;a++)if(e.plugins[a].name===i){e.plugins[a].plugin=t,e.plugins[a].options=n||{},o=!0;break}o||e.plugins.push({name:i,plugin:t,options:n})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,i){e&&("full"===this.loadType&&te.includes(e)||(t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:i}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk")))},e.prototype.init=function(t){var i,n=this;this.logger=new q(this.name,t.log),this.inited?this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):t&&u(t)?t.app_id&&"number"==typeof(i=t.app_id)&&!isNaN(i)?!t.app_key||function(e){return"string"==typeof e}(t.app_key)?(t.channel_domain||-1!==["cn","sg","va"].indexOf(t.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !"),t.channel="cn"),this.spider=new K,this.spider.checkSpider(t)?this.logger.warn("your env may be a spider, can not report!"):(this.appBridge=new J(this,t.enable_native),this.requestManager=new Y(this,t),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new H(this,t),this.debugger=new Z(this,t),this.initConfig=t,this.emit(j.Init),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cINIT",data:t,level:"info",time:Date.now()}),this.destroy=!1,t.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:t.app_id}),this.eventManager=new $,this.tokenManager=new Q,this.sessionManager=new F,Promise.all([new Promise((function(e){n.once(j.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){n.once(j.Start,(function(){e(!0)}))}))]).then((function(){try{e.plugins.reduce((function(e,t){var i=t.plugin,o=t.options,a=Object.assign(n.initConfig,o),r=new i;return r.apply(n,a),e.push(r),e}),n.pluginInstances)}catch(t){n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}n.sdkReady=!0,n.emit(j.Ready),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u521d\u59cb\u5316\u5b8c\u6210",time:Date.now(),level:"info",data:n.configManager.get("user")}),n.logger.info("appid: "+t.app_id+", userInfo:"+JSON.stringify(n.configManager.get("user"))),n.logger.info("appid: "+t.app_id+", sdk is ready, version type is "+n.loadType+", version is "+O+", you can report now !!!"),t.disable_auto_pv&&(n.disableAutoPageView=!0);try{"full"===n.loadType&&(t.enable_ab_test||t.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(t){n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}n.pageView(),n.on(j.TokenChange,(function(e){"webid"===e&&n.pageView(),n.logger.info("appid: "+t.app_id+" token change, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u8bbe\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user")})})),n.on(j.TokenReset,(function(){n.logger.info("appid: "+t.app_id+" token reset, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u91cd\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user")})})),n.on(j.RouteChange,(function(e){e.init||t.disable_route_report||n.pageView()}))})),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t)),this.inited=!0)):this.logger.warn("app_key param is error, must be string, please check!"):this.logger.warn("app_id param is error, must be number, please check!"):this.logger.warn("init params error,please check!")},e.prototype.config=function(e){if(this.inited&&e&&u(e))if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var t=n({},e),i=this.initConfig.configPersist||this.initConfig.config_persist||!1;if(this.initConfig&&i){var o=this.configManager.getStore();o&&(t=Object.assign(o,e)),this.configManager.setStore(e)}t.web_id,t.user_unique_id;var a=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(i[n[o]]=e[n[o]])}return i}(t,["web_id","user_unique_id"]);this.configManager.set(a),t.hasOwnProperty("web_id")&&this.emit(j.ConfigWebId,t.web_id),t.hasOwnProperty("user_unique_id")&&this.emit(j.ConfigUuid,t.user_unique_id),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cCONFIG",level:"info",time:Date.now(),data:t})}},e.prototype.setUserUniqueID=function(e){this.config({user_unique_id:e})},e.prototype.setHeaderInfo=function(e,t){var i={};i[e]=t,this.config(i)},e.prototype.removeHeaderInfo=function(e){var t={};t[e]=void 0,this.config(t)},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(j.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.started=!0,this.emit(j.Start),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cSTART",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(j.Ready)))},e.prototype.event=function(e,t){var i=this;try{var n=[];if(Array.isArray(e))e.forEach((function(e){var t=i.processEvent(e[0],e[1]||{});t&&n.push(t)}));else{var o=this.processEvent(e,t);if(!o)return;n.push(o)}this.bridgeReport?n.forEach((function(e){var t=e.event,n=e.params;i.appBridge.onEventV3(t,JSON.stringify(n))})):n.length&&(this.emit(j.Event,n),this.emit(j.SessionResetTime))}catch(e){this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e,t){if(Array.isArray(e));else{var i=[],n=this.processEvent(e,t||{});n&&(i.push(n),i.length&&(this.emit(j.BeconEvent,i),this.emit(j.SessionResetTime)))}},e.prototype.beaconEvent=function(e,t){this.beconEvent(e,t)},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{if(!e)return null;var i=e;/^event\./.test(e)&&(i=e.slice(6));var n=t;"object"!=typeof n&&(n={}),n.profile?delete n.profile:n.event_index=d();var o=void 0;return n.local_ms?(o=n.local_ms,delete n.local_ms):o=+new Date,{event:i,params:n,local_time_ms:o,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(i){return this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:i.message}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,i){this.hook.emit(e,t,i)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.stop=function(){this.sdkStop=!0},e.prototype.reStart=function(){this.sdkStop=!1},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){if(void 0===e&&(e={}),this.inited){var t={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},i=n({},t,e);this.event("predefine_pageview",i)}},e.prototype.clearEventCache=function(){this.emit(j.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=y(e);this.config({web_id:""+t,wechat_unionid:e}),this.emit(j.CustomWebId)}},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=y(e);this.config({web_id:""+t,wechat_openid:e}),this.emit(j.CustomWebId)}},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.getSessionId=function(){return W()},e.prototype.setSessionId=function(e){this.emit(j.SessionReset,e)},e.prototype.resetStayDuration=function(e,t,i){this.emit(j.ResetStay,{url_path:e,title:t,url:i},j.Stay)},e.prototype.resetStayParams=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),this.emit(j.SetStay,{url_path:e,title:t,url:i},j.Stay)},e.prototype.getToken=function(e,t){var i=this;if(this.inited){var o=!1,a=function(t){if(!o){o=!0;var a=i.configManager.get().user;return t&&(a.tobid=t,a["diss".split("").reverse().join("")]=t),e(n({},a))}},r=function(){i.tokenManager.getTobId().then((function(e){a(e)}))};this.sdkReady?r():(t&&setTimeout((function(){a()}),t),this.on(j.Ready,(function(){r()})))}},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(j.ProfileSet,e,j.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSet",level:"info",time:Date.now(),data:e})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(j.ProfileSetOnce,e,j.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSetOnce",level:"info",time:Date.now(),data:e})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(j.ProfileIncrement,e,j.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileIncrement",level:"info",time:Date.now(),data:e})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(j.ProfileUnset,e,j.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileUnset",level:"info",time:Date.now(),data:e})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(j.ProfileAppend,e,j.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileAppend",level:"info",time:Date.now(),data:e})},e.prototype.setExternalAbVersion=function(e){this.emit(j.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,j.Ab)},e.prototype.getVar=function(e,t,i){this.emit(j.AbVar,{name:e,defaultValue:t,callback:i},j.Ab)},e.prototype.getABconfig=function(e,t){this.emit(j.AbConfig,{params:e,callback:t},j.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(j.AbVersionChangeOn,e,j.Ab),function(){t.emit(j.AbVersionChangeOff,e,j.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(j.AbVersionChangeOff,e,j.Ab)},e.prototype.openOverlayer=function(){this.emit(j.AbOpenLayer,"",j.Ab)},e.prototype.closeOverlayer=function(){this.emit(j.AbCloseLayer,"",j.Ab)},e.prototype.getAllVars=function(e){this.emit(j.AbAllVars,e,j.Ab)},e.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(j.TokenComplete),this.emit(j.DestoryInstance))},e.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(j.TokenComplete),this.emit(j.DestoryInstance))},e.plugins=[],e}(),ne="__rangers_ab_style__",oe={},ae=[],re=function(e){e.length&&e.forEach((function(e){ae.push(e)}))};function se(e,t,i,n){var o=e&&e.source||window.opener||window.parent,a=e&&e.origin||n||"*",r={type:t,payload:i};o.postMessage(JSON.stringify(r),a)}function ce(e,t){oe[e]=oe[e]||[],oe[e].push(t)}function le(e){if(ae.some((function(e){return"*"===e}))||ae.some((function(t){return e.origin.indexOf(t)>-1}))){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(!t)return;var i=t.type,n=t.payload;oe[i]&&oe[i].forEach((function(t){"function"==typeof t&&t(e,n)}))}}function he(e,t){var i={};if(Object.keys(e).length)for(var n in e){if("filter"===n||"autotrack"===n||"enable_stay_duration"===n)break;i[n]=e[n]}(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:i,version:t},"*"),window.addEventListener("message",le,!1)}var ue,pe="",de=!1;function fe(e){var t=e.event,i=e.editorUrl;e.collectInstance,e.fromSession,de||(de=!0,m(i,(function(){se(t,"abEditorScriptloadSuccess")}),(function(){t&&se(t,"abEditorScriptloadError"),de=!1})))}!function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(ue||(ue={}));var ge=function(){function e(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return e.prototype.apply=function(e,t){var i=this;if(t.enable_ab_test){this.collect=e,this.config=t;var n=t.enable_multilink,o=t.ab_channel_domain,a=t.enable_ab_visual,r=t.ab_cross,s=t.ab_cookie_domain,c=t.ab_timeout,l=o||f(C[t.channel||"cn"]),h=e.adapters.storage,u=this.collect.Types;this.types=u,this.cacheStorgae=new h(!1),this.timeout=c||3e3,this.enable_multilink=n,this.enable_ab_visual=a,this.abKey="__tea_sdk_ab_version_"+t.app_id,this.ab_cross=r,this.ab_cookie_domain=s||"",this.fetchUrl=l+"/service/2/abtest_config/",this.reportUrl=""+e.configManager.getUrl("event"),this.exposureLimit=t.exposure_limit||20,this.ab_batch_time=t.ab_batch_time||500,this.ab_user_mode=t.ab_user_mode||"user_unique_id",this.collect.on(u.TokenChange,(function(e){"uuid"===e&&i.readyStatus&&(i.clearCache(),i.fetchAB())})),this.collect.on(u.TokenReset,(function(e){"uuid"===e&&i.readyStatus&&(i.clearCache(),i.fetchAB())})),this.collect.on(u.AbVar,(function(e){var t=e.name,n=e.defaultValue,o=e.callback;i.getVar(t,n,o)})),this.collect.on(u.AbAllVars,(function(e){i.getAllVars(e)})),this.collect.on(u.AbConfig,(function(e){var t=e.params,n=e.callback;i.getABconfig(t,n)})),this.collect.on(u.AbExternalVersion,(function(e){i.setExternalAbVersion(e)})),this.collect.on(u.AbOpenLayer,(function(){i.openOverlayer()})),this.collect.on(u.AbCloseLayer,(function(){i.closeOverlayer()})),this.collect.on(u.AbVersionChangeOn,(function(e){i.changeListener.set(e,e)})),this.collect.on(u.AbVersionChangeOff,(function(e){i.changeListener.get(e)&&i.changeListener.delete(e)})),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(u.AbReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var n=function(e){i[e].length&&i[e].forEach((function(i){t.collect.hook.emit(e,i)}))};for(var o in i)n(o)}},e.prototype.loadMode=function(){var e,t,i=function(){try{return JSON.parse(atob(window.name))||void 0}catch(e){return}}(),n="";if(i){var o=i.scenario,a=i.href;o?(this.editMode=!0,n=o):!a||-1===a.indexOf("datatester")&&-1===a.indexOf("visual-editor")||(this.editMode=!0,n="visual-editor")}this.enable_ab_visual&&(function(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{},re(["*"]);var i,n="";he(t,O);var o="";try{var a=window.performance.getEntriesByType("resource");if(a&&a.length&&(a.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(o=e.name)})),o||document.currentScript&&(o=document.currentScript.src),o&&(i=o.split("/"))&&i.length)){n="https:/";for(var r=2;r<i.length&&r!==i.length-1;r++)n=n+"/"+i[r];n+="/visual-ab-core"}}catch(e){}ce("tea:openVisualABEditor",(function(i){var o=i.data;if("string"==typeof i.data)try{o=JSON.parse(i.data)}catch(e){o=void 0}if(o){var a=o.lang;if(o.appId!==t.app_id)return void se(i,"appIdError");var r=o.version;pe=r&&n?n+(r?"."+r:".1.0.1")+".js?query="+Date.now():G+"?query="+Date.now(),window.TEAVisualEditor.lang=a,window.TEAVisualEditor.__ab_domin=t.channel_domain||"",fe({event:i,editorUrl:pe,collectInstance:e})}}))}(this.collect,this.config),"visual-editor"===n)?this.collect.destoryInstace():this.enable_multilink&&(e=this.collect,t=this.config,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=t.app_id,ce("tea:openTesterEventInspector",(function(t){var i=t.data;if("string"==typeof t.data)try{i=JSON.parse(t.data)}catch(e){i=void 0}if(i){var n=i.referrer,o=i.lang,a=i.appId;window.TEAVisualEditor.__editor_ajax_domain=n||"",window.TEAVisualEditor.__ab_appId=a||"",window.TEAVisualEditor.lang=o||"",fe({event:t,editorUrl:N+".js?query="+Date.now(),collectInstance:e})}})))},e.prototype.checkLocal=function(){var e=this.getABCache(),t=e.ab_version,i=e.ab_ext_version,n=e.ab_version_multilink,o=e.data,a=this.checkFromUrl();a?this.mulilinkVersions.push(a):this.mulilinkVersions=n||[],this.extVersions=i||[],this.versions=t||[],this.data=o;var r=this.versions.concat(this.extVersions);this.enable_multilink&&(r=r.concat(this.mulilinkVersions)),this.configVersions(r.join(","))},e.prototype.checkFromUrl=function(){var e=z(window.location.href);return e&&e.vid?e.vid:""},e.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(e=e.concat(this.mulilinkVersions)),this.configVersions(e.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach((function(t){"function"==typeof t&&t(e)}))},e.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},e.prototype.getVar=function(e,t,i){if(!e)throw new Error("variable must not be empty");if(void 0===t)throw new Error("variable no default value");if("function"!=typeof i)throw new Error("callback must be a function");var n={name:e,defaultValue:t,callback:i,type:ue.Var};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(n,e):this.callbacks.push(n)},e.prototype.getRealVar=function(e,t){var i=e.name,n=e.defaultValue,o=e.callback,a=this.data;if(a){if(u(a[i])){var r=a[i].vid;return"$ab_url"===t?this.mulilinkVersions.includes(r)||this.mulilinkVersions.push(r):this.versions.includes(r)||this.versions.push(r),this.updateVersions(),this.fechEvent(r,t,n),o(a[i].val),void this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u66dd\u5149\u4e86\u5b9e\u9a8c"+i,level:"info",time:Date.now(),data:a[i]})}this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8c03\u7528getVar",level:"info",time:Date.now(),data:n}),o(n)}else o(n)},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("callback must be a function");var t={callback:e,type:ue.All};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(t):this.callbacks.push(t)},e.prototype.getRealAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8c03\u7528getAllVars",level:"info",time:Date.now(),data:this.data})},e.prototype.fechEvent=function(e,t,i){try{if(this.config.disable_track_event)return;if(!e)return;var n=this.collect.configManager.get(),o=n.header,a=n.user,r=this.getABCache(),s=a[this.ab_user_mode]||a.user_unique_id;if(r&&r.uuid&&r.uuid!==s)return;var c={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===t?i:window.location.href}),local_time_ms:Date.now()};o.custom=JSON.stringify(o.custom);var h={events:[c],user:a,header:o};this.reportExposure(h,t)}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.reportExposure=function(e,t){var i=this;this.exposureCache.push(e),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report(t):this.reportTimeout=setTimeout((function(){i.report(t),clearTimeout(i.reportTimeout)}),this.ab_batch_time)},e.prototype.report=function(e){var t=this;this.collect.requestManager.useRequest({url:this.reportUrl,data:this.exposureCache,timeout:2e4,useBeacon:"$ab_url"===e}),this.exposureCache.forEach((function(e){t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:[e],code:200,status:"success"})})),this.exposureCache=[]},e.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},e.prototype.getABconfig=function(e,t){var i=Object.keys(e);i&&i.length&&this.collect.configManager.set(e),this.fetchAB(t)},e.prototype.get=function(e){if(this.ab_cross){var t=this.cacheStorgae.getCookie(e,this.ab_cookie_domain);return t?JSON.parse(t):{}}return this.cacheStorgae.getItem(e)},e.prototype.set=function(e,t){this.ab_cross?this.cacheStorgae.setCookie(e,t,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(e,t),this.collect.configManager.setAbCache(t)},e.prototype.getABCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return t=this.get(this.abKey)||t,e?t[e]:t},e.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.set(this.abKey,e)},e.prototype.setAbCache=function(e){var t=this.getABCache();t.data=this.data,t.uuid=e,t.timestamp=Date.now(),this.set(this.abKey,t)},e.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},e.prototype.openOverlayer=function(e){var t=this;if(function(){if(!document.getElementById(ne)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=ne,i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}}(),e)var i=setTimeout((function(){t.closeOverlayer(),clearTimeout(i)}),e)},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(ne))&&e.parentElement.removeChild(e)},e.prototype.fetchComplete=function(e,t){var i=this;try{if(e&&"[object Object]"==Object.prototype.toString.call(e)){this.data=e,this.setAbCache(t);var n=[];Object.keys(e).forEach((function(t){var i=e[t].vid;i&&n.push(i)})),this.versions=this.versions.filter((function(e){return n.includes(e)}));var o=e.$ab_url,a=e.$ab_modification;if(a&&a.val&&this.enable_ab_visual){if(this.collect.destroy)return;this.getVar("$ab_modification",window.location.href,(function(){var e;e=a.val,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.__ab_config=e,m(I+"?query="+Date.now(),(function(){}),(function(){})),i.closeOverlayer()}))}else if(o&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter((function(e){return n.includes(e)}));var r=o.val,s=o.vid;r&&s&&this.getVar("$ab_url",r,(function(){i.editMode||(r!==window.location.href?setTimeout((function(){if(!i.collect.destroy){var e=""+r;e=-1===e.indexOf("http")?"https://"+e:e,_(e).host!==location.host?e=e+"&vid="+s:window.history.replaceState("","",e),window.location.href=e}}),100):i.closeOverlayer())}))}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach((function(e){return i[e.type===ue.Var?"getRealVar":"getRealAllVars"](e,"")})),this.callbacks=[]}catch(e){}},e.prototype.fetchAB=function(e){var t=this,i=this.collect.configManager.get(),o={header:n({aid:this.config.app_id},i.user||{},i.header||{},{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77AB\u5b9e\u9a8c\u8bf7\u6c42",level:"info",logType:"fetch",time:Date.now(),data:o});var a=i.user[this.ab_user_mode]||i.user.user_unique_id;this.collect.requestManager.useRequest({url:this.fetchUrl,data:o,success:function(i){t.fetchStatus="complete",t.refreshFetchStatus="complete";var n=i.data;"success"===i.message?(t.fetchComplete(n,a),e&&e(n)):(t.fetchComplete(null,a),e&&e(null)),t.collect.emit(t.types.AbComplete,n),t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5b9e\u9a8c\u8bf7\u6c42\u6210\u529f",level:"info",logType:"fetch",time:Date.now(),data:n})},fail:function(){t.fetchStatus="complete",t.refreshFetchStatus="complete",t.fetchComplete(null,a),t.collect.emit(t.types.AbTimeout),e&&e(null),t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5b9e\u9a8c\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",level:"error",logType:"fetch",time:Date.now()})},timeout:this.timeout})},e}(),me=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;t.event_verify_url&&"string"==typeof t.event_verify_url&&(this.url=t.event_verify_url+"/v1/list_test",e.on(e.Types.SubmitBefore,(function(t){e.requestManager.useBeacon({url:i.url,data:t})})))},e}(),ve=function(){function e(e,t){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.focusState=!0,this.collect=e,this.config=t,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,u(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.hard=this.options.mode&&"hard"===this.options.mode,this.focusState=document.hasFocus(),this.aliveDTime=this.options.aliveTime||6e4}return e.prototype.setParams=function(e,t,i){this.set_path=e,this.set_url=i,this.set_title=t},e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this.enablePageAlive(),this.hard&&(this.removeMode=this.hardMode())},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now(),this.hard&&this.removeMode&&this.removeMode()},e.prototype.sendEvent=function(e,t){void 0===t&&(t=!1);var i=t?this.aliveDTime:Date.now()-this.sessionStartTime;i<0||i>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||t&&"hidden"===document.visibilityState||this.hard&&!this.focusState||(this.collect.beconEvent(this.options.aliveName,n({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:i,is_support_visibility_change:v(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:e,mode:this.hard?"hard":"normal",focusState:this.focusState},this.options.params)),this.sessionStartTime=Date.now())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.setUpTimer=function(){var e=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval((function(){Date.now()-e.sessionStartTime>e.aliveDTime&&e.sendEvent(!1,!0)}),1e3)},e.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},e.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},e.prototype.enablePageAlive=function(){var e=this;this.timerHandler=this.setUpTimer();var t=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",i),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",i)}},e.prototype.hardMode=function(){var e=this,t=function(){e.timerHandler&&(clearInterval(e.timerHandler),e.sendEvent(!1)),e.focusState=!1},i=function(){e.focusState=!0,e.sessionStartTime=Date.now(),e.timerHandler=e.setUpTimer()};return window.addEventListener("blur",t),window.addEventListener("focus",i),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",i)}},e}(),_e=function(){function e(e,t){var i=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.focusState=!0,this.visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=Date.now():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=Date.now())},this.beforeunload=function(){if(i.totalTime+=(i.activeEndTime||Date.now())-i.activeStartTime,i.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(e){}i.sendEventPageClose()},this.collect=e,this.config=t,this.maxDuration=t.maxDuration||t.max_duration||864e5,this.pageStartTime=Date.now(),u(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.hard=this.options.mode&&"hard"===this.options.mode,this.focusState=document.hasFocus(),this.resetData()}return e.prototype.setParams=function(e,t,i){this.set_path=e,this.set_url=i,this.set_title=t},e.prototype.resetParams=function(e,t,i){this.url_path=e,this.url=i,this.title=t},e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this.enablePageClose(),this.hard&&(this.removeMode=this.hardMode())},e.prototype.disable=function(){this.disableCallback(),this.hard&&this.removeMode&&this.removeMode()},e.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,document.title,location.href)},e.prototype.sendEventPageClose=function(){var e=Date.now()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||this.hard&&!this.focusState||(this.collect.beconEvent(this.options.closeName,n({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:v(),mode:this.hard?"hard":"normal",focusState:this.focusState},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.enablePageClose=function(){var e=this,t=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",i),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",i)}},e.prototype.hardMode=function(){var e=this,t=function(){e.focusState=!1},i=function(){e.focusState=!0};return window.addEventListener("blur",t),window.addEventListener("focus",i),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",i)}},e}(),ze=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(this.collect=e,this.config=t,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new ve(e,t),this.pageClose=new _e(e,t);var n=this.collect.Types;this.collect.on(n.DestoryInstance,(function(){i.disable()})),this.collect.on(n.ResetStay,(function(e){var t=e.url_path,n=e.title,o=e.url;i.resetStayDuration(t,n,o)})),this.collect.on(n.RouteChange,(function(e){e.init||t.disable_route_report||i.resetStayDuration()})),this.collect.on(n.SetStay,(function(e){var t=e.url_path,n=e.title,o=e.url;i.setStayParmas(t,n,o)})),this.enable(this.url_path,this.title,this.url),this.ready(n.Stay),this.collect.emit(n.StayReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var n=function(e){i[e].length&&i[e].forEach((function(i){t.collect.hook.emit(e,i)}))};for(var o in i)n(o)}},e.prototype.enable=function(e,t,i){this.pageAlive.enable(e,t,i),this.pageClose.enable(e,t,i)},e.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.setStayParmas=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),this.pageAlive.setParams(e,t,i),this.pageClose.setParams(e,t,i),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884c resetStayParams",level:"info",time:Date.now(),data:{url_path:e,title:t,url:i}})},e.prototype.reset=function(e,t,i){this.disable(),this.enable(e,t,i)},e.prototype.resetStayDuration=function(e,t,i){this.reset(e,t,i),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884c resetStayDuration",level:"info",time:Date.now(),data:{url_path:e,title:t,url:i}})},e}(),ye=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.config=t,this.duration=6e4,this.reportUrl=e.configManager.getDomain()+"/profile/list";var n=e.Types;this.eventCheck=new B(e,t),this.cache={},this.collect.on(n.ProfileSet,(function(e){i.setProfile(e)})),this.collect.on(n.ProfileSetOnce,(function(e){i.setOnceProfile(e)})),this.collect.on(n.ProfileUnset,(function(e){i.unsetProfile(e)})),this.collect.on(n.ProfileIncrement,(function(e){i.incrementProfile(e)})),this.collect.on(n.ProfileAppend,(function(e){i.appendProfile(e)})),this.collect.on(n.ProfileClear,(function(){i.cache={}})),this.ready(n.Profile)},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var n=function(e){i[e].length&&i[e].forEach((function(i){t.collect.hook.emit(e,i)}))};for(var o in i)n(o)}},e.prototype.report=function(e,t){void 0===t&&(t={});try{if(this.config.disable_track_event)return;var i=[];i.push(this.collect.processEvent(e,t));var n=this.collect.eventManager.merge(i);this.collect.requestManager.useRequest({url:this.reportUrl,data:n}),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:n,code:200,status:"success"})}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setProfile=function(e){var t=this.formatParams(e);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set",n({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this.formatParams(e,!0);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set_once",n({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e&&this.report("__profile_increment",n({},e,{profile:!0}))},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",n({},t,{profile:!0}))}},e.prototype.appendProfile=function(e){if(e){var t={};for(var i in e)("string"==typeof e[i]||"Array"===Object.prototype.toString.call(e[i]).slice(8,-1))&&(t[i]=e[i]);Object.keys(t).length&&this.report("__profile_append",n({},t,{profile:!0}))}},e.prototype.pushCache=function(e){var t=this;Object.keys(e).forEach((function(i){t.cache[i]={val:t.clone(e[i]),timestamp:Date.now()}}))},e.prototype.formatParams=function(e,t){var i=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return;var n={};for(var o in e)("string"==typeof e[o]||"number"==typeof e[o]||"Array"===Object.prototype.toString.call(e[o]).slice(8,-1))&&(n[o]=e[o]);var a=Object.keys(n);if(!a.length)return;if(!this.eventCheck.checkEventParams(n))return;var r=Date.now();return a.filter((function(n){var o=i.cache[n];return t?!o:!(o&&i.compare(o.val,e[n])&&r-o.timestamp<i.duration)})).reduce((function(e,t){return e[t]=n[t],e}),{})}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),!1}},e.prototype.clone=function(t){try{return JSON.parse(JSON.stringify(t))}catch(e){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),t}},e.prototype.unReady=function(){},e}(),be=function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var i,n=Date.now()+t;return i=window.setTimeout((function o(){var a=Date.now()-n;e(),n+=t,i=window.setTimeout(o,Math.max(0,t-a))}),t),function(){window.clearTimeout(i)}}((function(){e.isSessionhasEvent&&e.endCurrentSession()}),e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var i=this;if(this.collect=e,!t.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var n=this.collect.Types;this.collect.on(n.SessionResetTime,(function(){i.process()}))}},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}(),Ee=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;t.channel_domain||t.disable_track_event||t.disable_sdk_monitor||(this.collect=e,this.config=t,this.url=e.configManager.getUrl("event"),this.collect.on(e.Types.Ready,(function(){i.sdkOnload()})),this.collect.on(e.Types.SubmitError,(function(e){var t=e.type,n=e.eventData,o=e.errorCode;"f_data"===t&&i.sdkError(n,o)})))},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),i=t.header,n=t.user,o=i.app_id,a=i.app_name,r=i.sdk_version,s=n.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:o,app_name:a||"",sdk_version:r,sdk_type:"npm",sdk_config:this.config,sdk_desc:"TOC",url:location.href}),local_time_ms:Date.now()}],user:{user_unique_id:s},header:{}};setTimeout((function(){e.collect.requestManager.useRequest({url:e.url,data:[c],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})}),16)}catch(e){}},e.prototype.sdkError=function(e,t){var i=this;try{var n=e[0],o=n.user,a=n.header,r=[];e.forEach((function(e){e.events.forEach((function(e){r.push(e)}))}));var s={events:r.map((function(e){return{event:"on_error",params:JSON.stringify({error_code:t,app_id:a.app_id,app_name:a.app_name||"",error_event:e.event,sdk_version:a.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:JSON.stringify(a),user:JSON.stringify(o)}),local_time_ms:Date.now()}})),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout((function(){i.collect.requestManager.useRequest({url:i.url,data:[s],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})}),16)}catch(e){}},e}();function we(e,t,i){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaIdx"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaContainer"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0;if(i&&e.hasAttribute&&e.hasAttribute(i))return!0}return!1}function Se(e,t){for(var i=e;i&&!we(i,"container",t.container_attr||"");){if("HTML"===i.nodeName||"BODY"===i.nodeName)return e;i=i.parentElement}return i||e}var ke=function(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0},Te=function(e,t){if("string"==typeof t)return ke(e,t);if(p(t)){for(var i=!1,n=0;n<t.length;n++)if(ke(e,t[n])){i=!0;break}return i}},Ae=function(e,t){var i={};if("string"==typeof t)ke(e,t)&&(i.attrs=e.getAttribute(t));else if(p(t))for(var n=0;n<t.length;n++)ke(e,t[n])&&(i[t[n]]=e.getAttribute(t[n]));return i};var De=function(){function e(e,t,i){var o=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(e){(function(e,t){if(window.innerHeight,window.innerWidth,1!==e.nodeType)return!1;if(!t.svg&&function(e){if("svg"===e.tagName.toLowerCase())return!0;for(var t=e.parentElement,i=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,i=!0):t=t.parentElement;return i}(e))return!1;if(["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var i=e;return!("none"===i.style.display||!we(i,"container",t.container_attr||"")&&!(function(e,t){for(var i=e,n=!1;i&&!we(i,"container",t.container_attr||"");){if("HTML"===i.nodeName||"BODY"===i.nodeName)return n;i=i.parentElement}return!0}(i,t)||function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some((function(e){return e.children.length>0}))}return!0}(i)||t.svg))})(e.target,o.options)&&o.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){o.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){o.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t){t&&"pushState"===t&&o.eventHandel({eventType:"dom",eventName:"beat"},n({beat_type:0},e)),o.eventHandel({eventType:"dom",eventName:"page_view"},e)},this.getPageLoadEvent=function(e){o.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=i.getConfig().eventConfig,this.collect=t,this.options=e,this.beatTime=e.beat,this.domContainer=e.container||document}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e){if(this.config.click&&(p(this.domContainer)?this.domContainer.forEach((function(e){e.addEventListener("click",t.clickEvent,!0)})):this.domContainer.addEventListener("click",this.clickEvent,!0)),this.config.pv){this.collect.on("route-change",(function(e){var i=e.config,n=e.name;t.getPageViewEvent(i,n),t.pageView=!0}));var i=setTimeout((function(){t.pageView||(t.getPageViewEvent(t.getDefaultConfig()),t.pageView=!0,clearTimeout(i))}),2e3)}if(this.config.beat){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",(function(){t.beatEvent(t.beatTime)}));var n=0,o=null;window.addEventListener("scroll",(function(){clearTimeout(o),o=setTimeout(a,500),n=document.documentElement.scrollTop||document.body.scrollTop}));var a=function(){(document.documentElement.scrollTop||document.body.scrollTop)==n&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var r=window.performance&&window.performance.getEntriesByType("paint");if(r&&r.length){new PerformanceObserver((function(e){var i=e.getEntries(),n=i[i.length-1],o=n.renderTime||n.loadTime;t.statistics||(t.getPageLoadEvent(o),t.statistics=!0)})).observe({entryTypes:["largest-contentful-paint"]});var s=setTimeout((function(){t.statistics||(t.getPageLoadEvent(r[0].startTime||0),t.statistics=!0,clearTimeout(s))}),2e3)}else this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}}},e.prototype.removeListener=function(){var e=this;p(this.domContainer)?this.domContainer.forEach((function(t){t.removeEventListener("click",e.clickEvent,!0)})):this.domContainer.removeEventListener("click",this.clickEvent,!0)},e.prototype.beatEvent=function(e){var t=this;try{var i;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(i=setInterval((function(){t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})}),e)),g((function(){t.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),t.beatTime&&clearInterval(i)}))}catch(e){}},e.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},e}(),Ce={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},xe=function(){function e(e,t){this.config=e,this.config.eventConfig=Object.assign(this.config.eventConfig,t)}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function Oe(e,t,i,n){var o={},a=function(e){if(e){var t=e.getBoundingClientRect(),i=t.width,n=t.height;return{left:t.left,top:t.top,element_width:i,element_height:n}}}(t=Se(t,i)),r=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e.clientX,n=e.clientY,o=t.left,a=t.top,r=i-o>=0?i-o:0,s=n-a>=0?n-a:0;return{touch_x:Math.floor(r),touch_y:Math.floor(s)}}(e,a),s=a.element_width,c=a.element_height,l=r.touch_x,h=r.touch_y,u=function(e){var t=[];if(!e)return{element_path:"",positions:[]};for(;null!==e.parentElement;)t.push(e),e=e.parentElement;var i=[],n=[];return t.forEach((function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,i=e.parentElement;if(i)for(var n=i.children,o=0;o<n.length&&n[o]!==e;o++)n[o].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),we(e,"list")?"[]":""].join(""),index:t}}(e),o=t.str,a=t.index;i.unshift(o),n.unshift(a)})),{element_path:"/"+i.join("/"),positions:n}}(t),p=u.element_path,d=u.positions,f=function(e,t){var i=Se(e,t),n=[];return function e(t){var i=function(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}(t);if(i&&-1===n.indexOf(i)&&n.push(i),t.childNodes.length>0)for(var o=t.childNodes,a=0;a<o.length;a++)8!==o[a].nodeType&&e(o[a])}(i),n}(t,i),g=window.performance.timing.navigationStart,m=Date.now()-g,v=d.map((function(e){return""+e})),_=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(_=window.TEAVisualEditor.getOriginXpath({xpath:p,positions:v})),o.element_path=_&&_.xpath||p,o.positions=_&&_.positions||v,n&&!n.text&&(o.texts=f,o.element_title=t.getAttribute("title")||function(e){if(!e)return"";var t="";try{e.textContent?t=e.textContent.trim().replace(/\s+/g,","):e.innerText&&(t=e.innerText.trim().replace(/\s+/g,",")),"input"!==e.tagName&&"INPUT"!==e.tagName||(t=e.value||"")}finally{return t}}(t)),o.element_id=t.getAttribute("id")||"",o.element_class_name=t.getAttribute("class")||"",o.element_type=t.nodeType,o.element_width=Math.floor(s),o.element_height=Math.floor(c),o.touch_x=l,o.touch_y=h,o.page_manual_key="",o.elememt_manual_key="",o.since_page_start_ms=m,o.page_start_ms=g,o.page_path=location.pathname,o.page_host=location.host,i.track_attr&&function(e,t){return!!Te(e,t)}(t,i.track_attr)){var z=Ae(t,i.track_attr);for(var y in z)o[y]=z[y]}var b=Se(t,i);return"A"===b.tagName&&(o.href=b.getAttribute("href")),"IMG"===t.tagName&&(o.src=t.getAttribute("src")),o}var Me=function(e,t,i,o,a){return n({event:e},Oe(t,i,o,a),{is_html:1,page_key:window.location.href,page_title:document.title})},Ge=function(){function e(e,t){this.ignore={text:!1},this.initConfig=e,this.options=t,this.eventName=t&&"tea"===t.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"bav2b_exposure"},t&&!1===t.text&&(this.ignore.text=!0),t&&t.exposure&&t.exposure.eventName&&(this.eventName.exposure=t.exposure.eventName)}return e.prototype.handleEvent=function(e,t){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)return!1;t=t.parentNode}return!1}(e.target))return null;var i="bav2b_click";switch(t){case"click":return i=this.eventName.click,Me(i,e,e.target,this.options,this.ignore);case"exposure":return i=this.eventName.exposure,Me(i,e,e.target,this.options,this.ignore);case"change":return n({},Me(i="bav2b_change",e,e.target,this.options),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(i,e.target));case"submit":return Me(i="bav2b_submit",e,e.target,this.options)}}catch(n){return null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var i=JSON.parse(t);e.refer_page_duration_ms=i?i.duration:""}e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"",t.refer_page_manual_key="";try{var i=e.lcp,n=window.performance.timing,o=n.loadEventEnd-n.navigationStart;t.page_init_cost_ms=parseInt(i||(o>0?o:0)),t.page_start_ms=n.navigationStart}catch(e){}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{e.page_viewport_width=window.innerWidth,e.page_viewport_height=window.innerHeight,e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){}return e},e}(),Ie=function(){function e(e){this.collect=e,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){var i=e.eventSend,n=t.event;delete t.event,i&&"becon"===i?this.collect.beconEvent(n,t):this.collect.event(n,t)},e.prototype.get=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"GET"},t);fetch(e,i)},e.prototype.post=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"POST"},t);fetch(e,i)},e}(),Re="_TEA_VE_OPEN",Ne="_TEA_VE_APIHOST",Be="_VISUAL_EDITOR_V",je="_VISUAL_EDITOR_U";function Pe(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||b.get("lang"),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||b.get(Ne),i=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||b.get(Be),n=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||b.get(je),o=+new Date,a=new Date(o+18e5);b.set(Re,"1",{expires:a}),b.set(Ne,t,{expires:a}),b.set(je,n,{expires:a}),b.set("lang",e,{expires:a}),b.set(Be,i||"",{expires:a})}catch(e){}}var Ue=!1;function Ve(e){var t=e.event,i=e.editorUrl,n=e.autoTrackInstance;Ue||(Ue=!0,m(i,(function(){se(t,"editorScriptloadSuccess"),n.destroy()}),(function(){t&&se(t,"editorScriptloadError"),Ue=!1})))}var Le,He=function(){function e(e){this._instance=null,this._intersection=e,this.init()}return e.prototype.init=function(){var e=this;if(window.MutationObserver)try{this._instance=new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&e.attributeChangeObserve(t),"childList"===t.type&&e.modifyNodeObserve(t)}))})),this._instance.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})}catch(e){}},e.prototype.attributeChangeObserve=function(e){e.target.hasAttribute("data-exposure")?this.exposureAdd(e,"mutation"):this.exposureRemove(e)},e.prototype.modifyNodeObserve=function(e){var t=this;Array.from(e.addedNodes).forEach((function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureAdd(e,"intersect"),t.mapChild(e,t.exposureAdd.bind(t))})),Array.prototype.forEach.call(e.removedNodes,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureRemove(e),t.mapChild(e,t.exposureRemove.bind(t))}))},e.prototype.mapChild=function(e,t){var i=this;1===e.nodeType&&e.children.length&&Array.prototype.forEach.call(e.children,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t(e),i.mapChild(e,t)}))},e.prototype.exposureAdd=function(e,t){this._intersection&&this._intersection.exposureAdd(e,t)},e.prototype.exposureRemove=function(e){this._intersection&&this._intersection.exposureRemove(e)},e._exposure_observer=null,e}(),qe=function(){function e(t,i){this.count=1,this.instance=this.buildObserver(),this.observeMap=e._observer_map,t.autotrack.exposure.ratio?this.Ratio=t.autotrack.exposure.ratio:0===t.autotrack.exposure.ratio?this.Ratio=0:this.Ratio=.5,this.EventHandle=i}return e.prototype.buildObserver=function(){var t=this;if(!e._observer_instance)return IntersectionObserver&&(e._observer_instance=new IntersectionObserver((function(e){e.forEach((function(e){t.observeMap.get(e.target._observeId)&&t.exposureEvent(e)}))}),{threshold:[.01,.25,.5,.75,1]})),e._observer_instance},e.prototype.exposureAdd=function(e,t){var i=e;"mutation"===t&&(i=e.target);var n=i._observeId;if(n||this.observeMap.has(n)){if(!1===i.visible){var o=i.getBoundingClientRect(),a=o.top,r=o.left,s=o.right,c=o.bottom;a>=0&&c<=window.innerHeight&&r>=0&&s<=window.innerWidth&&(i.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e))}}else i._observeId=this.count,i.visible=!1,this.observeMap.set(this.count,i),this.observe(i),this.count++},e.prototype.exposureRemove=function(e){this.observeMap.has(e._observeId)&&(this.observeMap.delete(e._observeId),this.unobserve(e))},e.prototype.exposureEvent=function(e){if(e.intersectionRatio>=this.Ratio&&e.isIntersecting){if("0"===e.target.style.opacity||"hidden"===e.target.style.visibility)return;if(!0===e.target.visible)return;e.target.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e)}else e.target.visible=!1},e.prototype.observe=function(e){this.instance.observe(e)},e.prototype.unobserve=function(e){this.instance.unobserve(e)},e._observer_instance=null,e._observer_map=new Map,e}(),Ke=function(){function e(e,t){e.autotrack&&e.autotrack.exposure&&(this._intersection=new qe(e,t),this._observer=new He(this._intersection),this.initObserver())}return e.prototype.initObserver=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),(function(t){e._intersection.exposureAdd(t,"intersect")}))},e}(),Je={hashTag:!1,impr:!1},We=function(){function e(){}return e.prototype.apply=function(e,t){if(this.autoTrackStart=!1,this.collect=e,this.config=t,t.autotrack){var i=e.Types;t.autotrack&&t.autotrack.collect_url&&!t.autotrack.collect_url()||(this.ready(i.Autotrack),this.collect.emit(i.AutotrackReady))}},e.prototype.ready=function(e){this.collect.set(e);var t=this.config.autotrack;t="object"==typeof t?t:{},t=Object.assign(Je,t),this.destroyed=!1,this.options=t,this.Config=new xe(Ce,this.options),this.Exposure=new Ke(this.config,this.handle.bind(this)),this.Listener=new De(t,this.collect,this.Config),this.EventHandle=new Ge(this.config,t),this.Request=new Ie(this.collect),this.autoTrackStart=!0,this.init(),function(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{};var i="",n=M+"?query="+Date.now();window.TEAVisualEditor.appId=t.app_id;var o=t.channel_domain,a="";if(re(["*"]),o){var r,s="";try{var c=window.performance.getEntriesByType("resource");if(c&&c.length&&(c.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(s=e.name)})),s&&(r=s.split("/"))&&r.length)){a="https:/";for(var l=2;l<r.length&&l!==r.length-1;l++)a=a+"/"+r[l];if(a&&a.indexOf("/5.0")){var h=a.split("/5.0");a=h[0]||a}}}catch(e){}}if(he(t,O),"1"===b.get(Re)){var u=function(){var e=b.get(Ne);try{e=JSON.parse(e)}catch(e){}return e}(),p="";u&&(window.TEAVisualEditor.__editor_ajax_domain=u,p=b.get(je)),Ve({event:null,editorUrl:p||n,autoTrackInstance:e}),Pe()}else try{ce("tea:openVisualEditor",(function(t){var r=t.data;if("string"==typeof t.data)try{r=JSON.parse(t.data)}catch(e){r=void 0}if(r){var s=r.referrer,c=r.lang;if(s&&(window.TEAVisualEditor.__editor_ajax_domain=s),i=n,o){var l=r.version;i=a?a+(l?"/visual-editor-rangers-v"+l:"/visual-editor-rangers-v1.0.0")+".js":n,window.TEAVisualEditor.__editor_verison=l}window.TEAVisualEditor.__editor_url=i,window.TEAVisualEditor.lang=c,Ve({event:t,editorUrl:i,autoTrackInstance:e}),Pe()}})),window.TEAVisualEditor.openAutotrackEditor=function(){Ve({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(e){}try{ce("tea:openHeatMapCore",(function(i){var n=R,o=i.data.app_id;o&&o!==t.app_id||Ve({event:i,editorUrl:n+".js?query="+Date.now(),autoTrackInstance:e})}))}catch(e){}}(this,this.config)},e.prototype.init=function(){this.Listener.init(this.handle.bind(this));try{"base"===this.collect.loadType&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var i=e.eventName;if("click"===i||"exposure"===i||"change"===i||"submit"===i){var n=this.EventHandle.handleEvent(t,i);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},n)}else if("page_view"===i||"page_statistics"===i){var o;o="page_view"===i?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},o)}else if("beat"===i){var a=this.EventHandle.handleBeadtEvent(t),r=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:r},a)}}catch(e){}},e.prototype.destroy=function(){this.autoTrackStart&&(this.autoTrackStart=!1,this.Listener.removeListener())},e}();!function(e){e.Net="net",e.FailNet="f_net",e.FailData="f_data"}(Le||(Le={}));var Fe={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},$e=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(t.app_id&&t.enable_tracer&&!t.disable_track_event){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=e,this.appid=t.app_id,this.reportUrl=e.configManager.getUrl("event");var n=this.collect.Types;this.collect.on(n.Event,(function(){i.addCount("log")})),this.collect.on(n.SubmitError,(function(e){var t=e.type,n=e.eventDate,o=e.errorCode,a=e.response;i.addErrorCount(n,t,o,a)})),this.listener(),this.collect.emit(n.TracerReady)}},e.prototype.addCount=function(e,t,i){void 0===t&&(t="net"),void 0===i&&(i=1);try{this.tracerCache||(this.tracerCache=new Map);var n=void 0;if(this.tracerCache.has(e))(o=this.tracerCache.get(e)).has(t)?(n=o.get(t).params.count,n++,o.set(t,this.processTracer(n,e,t))):(n=i,o.set(t,this.processTracer(i,e,t)));else{var o=new Map;n=i,o.set(t,this.processTracer(i,e,t)),this.tracerCache.set(e,o)}"net"===t&&n>=this.limit[e]&&this.report(!1)}catch(e){}},e.prototype.addErrorCount=function(e,t,i,n){var o=this;try{if(e&&e.length){var a=e[0].events;a&&a.length&&("f_data"===t?(n&&n.hasOwnProperty("sc")?this.addCount("log",t,a.length-n.sc):this.addCount("log",t,a.length),this.errorCode[t]=i):a.forEach((function(e){var n="log";for(var a in Fe)if(-1!==Fe[a].indexOf(e.event)){n=a;break}o.addCount(n,t,1),o.errorCode[t]=i})))}}catch(e){}},e.prototype.report=function(e){if(this.tracerCache){var t=[];this.tracerCache.forEach((function(e){e.forEach((function(e){t.push(e)}))})),t&&t.length&&this.sendTracer(t,e)}},e.prototype.sendTracer=function(e,t){try{var i=this.collect.eventManager.merge(e);this.collect.requestManager.useRequest({url:this.reportUrl,data:i,useBeacon:t}),this.tracerCache=null}catch(e){}},e.prototype.processTracer=function(e,t,i){var n={count:e,state:i,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:O};"f_net"!==i&&"f_data"!==i||(n.errorCode=this.errorCode[i]);var o=this.collect.processEvent("applog_trace",n);if(o&&o.event)return delete o.is_bav,o},e.prototype.listener=function(){var e=this;document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.leavePage()})),g((function(){e.leavePage()}))},e.prototype.leavePage=function(){this.report(!0)},e}(),Xe=function(){function e(){this.retryWaitTime=3e3,this.retryStatus=!1,this.retryCacheStatus=!1}return e.prototype.apply=function(e,t){var i=this;if(t.enable_storage&&!t.disable_storage&&(this.collect=e,this.config=t,!this.collect.destroy)){var n=e.Types,o=e.adapters.storage;this.storage=new o(!1),this.eventUrl=this.collect.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+t.app_id,this.storageNum=t.storage_num||50,this.retryNum=t.retry_num||3,this.retryInterval=1e3,e.on(n.SubmitError,(function(e){"f_data"!==e.type&&i.storeData(e)})),e.on(n.Ready,(function(){i.checkStorage()}))}},e.prototype.retryRightNow=function(e){var t=this;if(this.retryStatus)this.errorCache.push(e);else{var i=0;this.retryStatus=!0;var n=setInterval((function(){if(3===i)return t.storeData(t.errorCache),t.retryStatus=!1,void clearInterval(n);var o=e.eventData;t.fetchData(o,(function(){t.retryStatus=!1,clearInterval(n),t.retryCacheStatus&&t.errorCache.splice(0,1),t.errorCache.length&&(t.retryCacheStatus=!0,t.retryRightNow(t.errorCache[0]))}),(function(){i++}))}),this.retryInterval)}},e.prototype.storeData=function(e){var t=this.storage.getItem(this.eventKey),i=e.eventData;Object.keys(t).length!==this.storageNum&&(t[Date.now()]=i,this.storage.setItem(this.eventKey,t))},e.prototype.checkStorage=function(){var e=this;try{if(!window.navigator.onLine)return;var t=this.storage.getItem(this.eventKey);if(!t||!Object.keys(t).length)return;var i={events:[{event:"ontest",params:{app_id:this.config.app_id},local_time_ms:Date.now()}],user:{user_unique_id:this.collect.configManager.get("web_id")},header:{}};this.fetchData([i],(function(){var i=JSON.parse(JSON.stringify(t)),n=function(n){e.fetchData(t[n],(function(){delete i[n],e.storage.setItem(e.eventKey,i)}),(function(){}),!1)};for(var o in t)n(o)}),(function(){}),!0)}catch(e){}},e.prototype.fetchData=function(e,t,i,n){this.collect.requestManager.useRequest({url:this.eventUrl,data:e,timeout:3e4,success:t,fail:i,app_key:n?"566f58151b0ed37e":""})},e}(),Qe="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,Ye=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,i){if("sdk"===t){if(ee.hasOwnProperty(i)){var n=ee[i].object,o=ee[i].src[e.channel]+"?query="+Date.now();e.exist(i,n,o)}}else"object"==typeof t&&(t.src?e.exist(i,t.call,t.src):e.process(i,t.instance,"INSTANCE"))}))}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.exist=function(e,t,i){var n=this;Qe[t]?this.process(e,Qe[t]):this.loadPlugin(e,i,(function(){n.process(e,Qe[t])}),(function(){}))},e.prototype.process=function(e,t,i){try{if(i){var n=new t;n.apply&&n.apply(this.collect,this.config)}else t&&t(this.collect,this.config)}catch(t){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}},e.prototype.loadPlugin=function(e,t,i,n){var o=this;try{var a=document.createElement("script");a.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(i),a.onerror=function(){n(t)},a.onload=function(){o._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(a)}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e}(),Ze=function(){function e(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return e.prototype.apply=function(e,t){if(t.spa||t.autotrack){var i=e.Types;this.collect=e,this.config=t,this.appid=t.app_id,this.allowHash=t.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),e.emit(i.RouteReady)}},e.prototype.setKey=function(){var e=this.collect.adapters.storage;this.storage=new e(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:"",refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&"object"==typeof this.config.autotrack&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(!e.collect.sdkStop&&!e.collect.destroy){"function"==typeof history.onpushstate&&history.onpushstate({state:i});var r=t.call.apply(t,a([history,i],n));if(e.lastLocation!==location.href){var s=e.getPopStateChangeEventData();return e.setReferCache(e.lastLocation),e.lastLocation=location.href,e.sendPv(s,"pushState"),r}}};var i=history.replaceState;history.replaceState=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(!e.collect.sdkStop&&!e.collect.destroy){"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var r=i.call.apply(i,a([history,t],n));if(e.lastLocation!==location.href){var s=e.getPopStateChangeEventData();return e.setReferCache(e.lastLocation),e.lastLocation=location.href,e.sendPv(s),r}}}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.getLocation=function(){return this.lastLocation},e.prototype.init=function(){var e=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:e,init:!0})},e.prototype.listener=function(){var e=this,t=null;window.addEventListener("hashchange",(function(i){if(!e.collect.sdkStop&&!e.collect.destroy&&e.lastLocation!==window.location.href&&(clearTimeout(t),e.allowHash)){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var n=e.getPopStateChangeEventData();e.sendPv(n)}})),window.addEventListener("popstate",(function(i){e.collect.sdkStop||e.collect.destroy||e.lastLocation!==window.location.href&&(t=setTimeout((function(){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var t=e.getPopStateChangeEventData();e.sendPv(t)}),10))}))},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){try{var e,t=this.storage.getItem(this.cache_key)||{},i=this.storage.getItem("__tea_cache_first_"+this.appid);return e=!i||1!=i,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:t&&t.refer_manual_key||"",refer_page_title:t&&t.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+e}}catch(t){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message}),{}}},e.prototype.sendPv=function(e,t){this.collect.emit("route-change",{config:e,init:!1})},e.prototype.handleRefer=function(){var e="";try{var t=this.storage.getItem()||{};e=t.routeChange?t.refer_key:this.collect.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.setReferCache=function(e){var t=this.storage.getItem(this.cache_key)||{};t.refer_key=e,t.routeChange=!0,this.storage.setItem(this.cache_key,t)},e}();ie.usePlugin(Ye,"extend"),ie.usePlugin(ge,"ab"),ie.usePlugin(ze,"stay"),ie.usePlugin(We,"autotrack"),ie.usePlugin(me,"et"),ie.usePlugin(ye,"profile"),ie.usePlugin(Xe,"retry"),ie.usePlugin(be,"heartbeat"),ie.usePlugin(Ee,"monitor"),ie.usePlugin(Ze,"route"),ie.usePlugin($e,"tracer");var et=new ie("default"),tt=ie;t.b=et},"2346a262bb7ecd6ac22b":function(e,t,i){"use strict";var n,o,a=function(){return(a=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},s=(+Date.now()+Number((""+Math.random()).slice(2,8)),function(){var e=0;return["hidden","msHidden","webkitHidden"].forEach((function(t){void 0!==document[t]&&(e=1)})),e}),c=function(){function e(e,t){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.focusState=!0,this.collect=e,this.config=t,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,r(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.hard=this.options.mode&&"hard"===this.options.mode,this.focusState=document.hasFocus(),this.aliveDTime=this.options.aliveTime||6e4}return e.prototype.setParams=function(e,t,i){this.set_path=e,this.set_url=i,this.set_title=t},e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this.enablePageAlive(),this.hard&&(this.removeMode=this.hardMode())},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now(),this.hard&&this.removeMode&&this.removeMode()},e.prototype.sendEvent=function(e,t){void 0===t&&(t=!1);var i=t?this.aliveDTime:Date.now()-this.sessionStartTime;i<0||i>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||t&&"hidden"===document.visibilityState||this.hard&&!this.focusState||(this.collect.beconEvent(this.options.aliveName,a({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:i,is_support_visibility_change:s(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:e,mode:this.hard?"hard":"normal",focusState:this.focusState},this.options.params)),this.sessionStartTime=Date.now())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.setUpTimer=function(){var e=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval((function(){Date.now()-e.sessionStartTime>e.aliveDTime&&e.sendEvent(!1,!0)}),1e3)},e.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},e.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},e.prototype.enablePageAlive=function(){var e=this;this.timerHandler=this.setUpTimer();var t=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",i),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",i)}},e.prototype.hardMode=function(){var e=this,t=function(){e.timerHandler&&(clearInterval(e.timerHandler),e.sendEvent(!1)),e.focusState=!1},i=function(){e.focusState=!0,e.sessionStartTime=Date.now(),e.timerHandler=e.setUpTimer()};return window.addEventListener("blur",t),window.addEventListener("focus",i),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",i)}},e}(),l=function(){function e(e,t){var i=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.focusState=!0,this.visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=Date.now():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=Date.now())},this.beforeunload=function(){if(i.totalTime+=(i.activeEndTime||Date.now())-i.activeStartTime,i.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(e){}i.sendEventPageClose()},this.collect=e,this.config=t,this.maxDuration=t.maxDuration||t.max_duration||864e5,this.pageStartTime=Date.now(),r(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.hard=this.options.mode&&"hard"===this.options.mode,this.focusState=document.hasFocus(),this.resetData()}return e.prototype.setParams=function(e,t,i){this.set_path=e,this.set_url=i,this.set_title=t},e.prototype.resetParams=function(e,t,i){this.url_path=e,this.url=i,this.title=t},e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this.enablePageClose(),this.hard&&(this.removeMode=this.hardMode())},e.prototype.disable=function(){this.disableCallback(),this.hard&&this.removeMode&&this.removeMode()},e.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,document.title,location.href)},e.prototype.sendEventPageClose=function(){var e=Date.now()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||this.hard&&!this.focusState||(this.collect.beconEvent(this.options.closeName,a({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:s(),mode:this.hard?"hard":"normal",focusState:this.focusState},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.enablePageClose=function(){var e=this,t=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",i),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",i)}},e.prototype.hardMode=function(){var e=this,t=function(){e.focusState=!1},i=function(){e.focusState=!0};return window.addEventListener("blur",t),window.addEventListener("focus",i),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",i)}},e}();!function(e){e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.UnReady="un-ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.SetSessionId="set-session-id",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.AbTimeout="ab-timeout",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready",e.sessionRecord="session-record",e.SessionRecordStart="session-record-start",e.SessionRecordPause="session-record-pause",e.SessionRecordEnd="session-record-end",e.SessionRecordReport="session-record-report",e.DestoryInstance="destory-instance",e.VisualCollectReady="visual-collect-ready",e.VisualApiReady="visual-api-ready",e.VisualApiUpdate="visual-api-update"}(n||(n={})),function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(o||(o={})),t.a=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(this.collect=e,this.config=t,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new c(e,t),this.pageClose=new l(e,t);var n=this.collect.Types;this.collect.on(n.DestoryInstance,(function(){i.disable()})),this.collect.on(n.ResetStay,(function(e){var t=e.url_path,n=e.title,o=e.url;i.resetStayDuration(t,n,o)})),this.collect.on(n.RouteChange,(function(e){e.init||t.disable_route_report||i.resetStayDuration()})),this.collect.on(n.SetStay,(function(e){var t=e.url_path,n=e.title,o=e.url;i.setStayParmas(t,n,o)})),this.enable(this.url_path,this.title,this.url),this.ready(n.Stay),this.collect.emit(n.StayReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var n=function(e){i[e].length&&i[e].forEach((function(i){t.collect.hook.emit(e,i)}))};for(var o in i)n(o)}},e.prototype.enable=function(e,t,i){this.pageAlive.enable(e,t,i),this.pageClose.enable(e,t,i)},e.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.setStayParmas=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),this.pageAlive.setParams(e,t,i),this.pageClose.setParams(e,t,i),this.collect.emit(o.DEBUGGER_MESSAGE,{type:o.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884c resetStayParams",level:"info",time:Date.now(),data:{url_path:e,title:t,url:i}})},e.prototype.reset=function(e,t,i){this.disable(),this.enable(e,t,i)},e.prototype.resetStayDuration=function(e,t,i){this.reset(e,t,i),this.collect.emit(o.DEBUGGER_MESSAGE,{type:o.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884c resetStayDuration",level:"info",time:Date.now(),data:{url_path:e,title:t,url:i}})},e}()},"947b83917a7e6a283fd5":function(e,t,i){"use strict";var n=function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=function(e){return Array.isArray(e)},a=(+Date.now()+Number((""+Math.random()).slice(2,8)),function(e){return function(e,t,i){if("string"==typeof e&&"number"==typeof i){var n,o=[];i=i<=25?i:i%25;var a=String.fromCharCode(i+97);n=e.split(a);for(var r=0;r<n.length;r++){var s=parseInt(n[r],i);s=1*s^64;var c=String.fromCharCode(s);o.push(c)}return o.join("")}}(e,0,25)});function r(e,t,i){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaIdx"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaContainer"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0;if(i&&e.hasAttribute&&e.hasAttribute(i))return!0}return!1}var s=function(e,t){return!!h(e,t)};function c(e,t){for(var i=e;i&&!r(i,"container",t.container_attr||"");){if("HTML"===i.nodeName||"BODY"===i.nodeName)return e;i=i.parentElement}return i||e}var l=function(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0},h=function(e,t){if("string"==typeof t)return l(e,t);if(o(t)){for(var i=!1,n=0;n<t.length;n++)if(l(e,t[n])){i=!0;break}return i}},u=function(e,t){var i={};if("string"==typeof t)l(e,t)&&(i.attrs=e.getAttribute(t));else if(o(t))for(var n=0;n<t.length;n++)l(e,t[n])&&(i[t[n]]=e.getAttribute(t[n]));return i};var p=function(){function e(e,t,i){var o=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(e){(function(e,t){if(window.innerHeight,window.innerWidth,1!==e.nodeType)return!1;if(!t.svg&&function(e){if("svg"===e.tagName.toLowerCase())return!0;for(var t=e.parentElement,i=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,i=!0):t=t.parentElement;return i}(e))return!1;if(["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var i=e;return!("none"===i.style.display||!r(i,"container",t.container_attr||"")&&!(function(e,t){for(var i=e,n=!1;i&&!r(i,"container",t.container_attr||"");){if("HTML"===i.nodeName||"BODY"===i.nodeName)return n;i=i.parentElement}return!0}(i,t)||function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some((function(e){return e.children.length>0}))}return!0}(i)||t.svg))})(e.target,o.options)&&o.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){o.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){o.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t){t&&"pushState"===t&&o.eventHandel({eventType:"dom",eventName:"beat"},n({beat_type:0},e)),o.eventHandel({eventType:"dom",eventName:"page_view"},e)},this.getPageLoadEvent=function(e){o.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=i.getConfig().eventConfig,this.collect=t,this.options=e,this.beatTime=e.beat,this.domContainer=e.container||document}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e){if(this.config.click&&(o(this.domContainer)?this.domContainer.forEach((function(e){e.addEventListener("click",t.clickEvent,!0)})):this.domContainer.addEventListener("click",this.clickEvent,!0)),this.config.pv){this.collect.on("route-change",(function(e){var i=e.config,n=e.name;t.getPageViewEvent(i,n),t.pageView=!0}));var i=setTimeout((function(){t.pageView||(t.getPageViewEvent(t.getDefaultConfig()),t.pageView=!0,clearTimeout(i))}),2e3)}if(this.config.beat){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",(function(){t.beatEvent(t.beatTime)}));var n=0,a=null;window.addEventListener("scroll",(function(){clearTimeout(a),a=setTimeout(r,500),n=document.documentElement.scrollTop||document.body.scrollTop}));var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==n&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var s=window.performance&&window.performance.getEntriesByType("paint");if(s&&s.length){new PerformanceObserver((function(e){var i=e.getEntries(),n=i[i.length-1],o=n.renderTime||n.loadTime;t.statistics||(t.getPageLoadEvent(o),t.statistics=!0)})).observe({entryTypes:["largest-contentful-paint"]});var c=setTimeout((function(){t.statistics||(t.getPageLoadEvent(s[0].startTime||0),t.statistics=!0,clearTimeout(c))}),2e3)}else this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}}},e.prototype.removeListener=function(){var e=this;o(this.domContainer)?this.domContainer.forEach((function(t){t.removeEventListener("click",e.clickEvent,!0)})):this.domContainer.removeEventListener("click",this.clickEvent,!0)},e.prototype.beatEvent=function(e){var t,i=this;try{var n;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(n=setInterval((function(){i.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})}),e)),t=function(){i.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),i.beatTime&&clearInterval(n)},navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",t,!1):window.addEventListener("beforeunload",t,!1)}catch(e){}},e.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},e}(),d={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},f=function(){function e(e,t){this.config=e,this.config.eventConfig=Object.assign(this.config.eventConfig,t)}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function g(e){var t=[];if(!e)return{element_path:"",positions:[]};for(;null!==e.parentElement;)t.push(e),e=e.parentElement;var i=[],n=[];return t.forEach((function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,i=e.parentElement;if(i)for(var n=i.children,o=0;o<n.length&&n[o]!==e;o++)n[o].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),r(e,"list")?"[]":""].join(""),index:t}}(e),o=t.str,a=t.index;i.unshift(o),n.unshift(a)})),{element_path:"/"+i.join("/"),positions:n}}var m=function(e,t,i,o,a){return n({event:e},function(e,t,i,n){var o={},a=function(e){if(e){var t=e.getBoundingClientRect(),i=t.width,n=t.height;return{left:t.left,top:t.top,element_width:i,element_height:n}}}(t=c(t,i)),r=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e.clientX,n=e.clientY,o=t.left,a=t.top,r=i-o>=0?i-o:0,s=n-a>=0?n-a:0;return{touch_x:Math.floor(r),touch_y:Math.floor(s)}}(e,a),l=a.element_width,h=a.element_height,p=r.touch_x,d=r.touch_y,f=g(t),m=f.element_path,v=f.positions,_=function(e,t){var i=c(e,t),n=[];return function e(t){var i=function(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}(t);if(i&&-1===n.indexOf(i)&&n.push(i),t.childNodes.length>0)for(var o=t.childNodes,a=0;a<o.length;a++)8!==o[a].nodeType&&e(o[a])}(i),n}(t,i),z=window.performance.timing.navigationStart,y=Date.now()-z,b=v.map((function(e){return""+e})),E=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(E=window.TEAVisualEditor.getOriginXpath({xpath:m,positions:b})),o.element_path=E&&E.xpath||m,o.positions=E&&E.positions||b,n&&!n.text&&(o.texts=_,o.element_title=t.getAttribute("title")||function(e){if(!e)return"";var t="";try{e.textContent?t=e.textContent.trim().replace(/\s+/g,","):e.innerText&&(t=e.innerText.trim().replace(/\s+/g,",")),"input"!==e.tagName&&"INPUT"!==e.tagName||(t=e.value||"")}finally{return t}}(t)),o.element_id=t.getAttribute("id")||"",o.element_class_name=t.getAttribute("class")||"",o.element_type=t.nodeType,o.element_width=Math.floor(l),o.element_height=Math.floor(h),o.touch_x=p,o.touch_y=d,o.page_manual_key="",o.elememt_manual_key="",o.since_page_start_ms=y,o.page_start_ms=z,o.page_path=location.pathname,o.page_host=location.host,i.track_attr&&s(t,i.track_attr)){var w=u(t,i.track_attr);for(var S in w)o[S]=w[S]}var k=c(t,i);return"A"===k.tagName&&(o.href=k.getAttribute("href")),"IMG"===t.tagName&&(o.src=t.getAttribute("src")),o}(t,i,o,a),{is_html:1,page_key:window.location.href,page_title:document.title})},v=function(){function e(e,t){this.ignore={text:!1},this.initConfig=e,this.options=t,this.eventName=t&&"tea"===t.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"bav2b_exposure"},t&&!1===t.text&&(this.ignore.text=!0),t&&t.exposure&&t.exposure.eventName&&(this.eventName.exposure=t.exposure.eventName)}return e.prototype.handleEvent=function(e,t){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)return!1;t=t.parentNode}return!1}(e.target))return null;var i="bav2b_click";switch(t){case"click":return i=this.eventName.click,m(i,e,e.target,this.options,this.ignore);case"exposure":return i=this.eventName.exposure,m(i,e,e.target,this.options,this.ignore);case"change":return n({},m(i="bav2b_change",e,e.target,this.options),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(i,e.target));case"submit":return m(i="bav2b_submit",e,e.target,this.options)}}catch(e){return null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var i=JSON.parse(t);e.refer_page_duration_ms=i?i.duration:""}e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"",t.refer_page_manual_key="";try{var i=e.lcp,n=window.performance.timing,o=n.loadEventEnd-n.navigationStart;t.page_init_cost_ms=parseInt(i||(o>0?o:0)),t.page_start_ms=n.navigationStart}catch(e){}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{e.page_viewport_width=window.innerWidth,e.page_viewport_height=window.innerHeight,e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){}return e},e}(),_=function(){function e(e){this.collect=e,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){var i=e.eventSend,n=t.event;delete t.event,i&&"becon"===i?this.collect.beconEvent(n,t):this.collect.event(n,t)},e.prototype.get=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"GET"},t);fetch(e,i)},e.prototype.post=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"POST"},t);fetch(e,i)},e}(),z={},y=[];function b(e,t,i,n){var o=e&&e.source||window.opener||window.parent,a=e&&e.origin||n||"*",r={type:t,payload:i};o.postMessage(JSON.stringify(r),a)}function E(e,t){z[e]=z[e]||[],z[e].push(t)}function w(e){if(y.some((function(e){return"*"===e}))||y.some((function(t){return e.origin.indexOf(t)>-1}))){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(!t)return;var i=t.type,n=t.payload;z[i]&&z[i].forEach((function(t){"function"==typeof t&&t(e,n)}))}}var S,k=(function(e,t){var i;i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function o(){}function a(t,i,a){if("undefined"!=typeof document){"number"==typeof(a=e({path:"/"},o.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var r=JSON.stringify(i);/^[\{\[]/.test(r)&&(i=r)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in a)a[c]&&(s+="; "+c,!0!==a[c]&&(s+="="+a[c].split(";")[0]));return document.cookie=t+"="+i+s}}function r(e,i){if("undefined"!=typeof document){for(var o={},a=document.cookie?document.cookie.split("; "):[],r=0;r<a.length;r++){var s=a[r].split("="),c=s.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(n.read||n)(c,l)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(o[l]=c,e===l)break}catch(e){}}return e?o[e]:o}}return o.set=a,o.get=function(e){return r(e,!1)},o.getJSON=function(e){return r(e,!0)},o.remove=function(t,i){a(t,"",e(i,{expires:-1}))},o.defaults={},o.withConverter=i,o}((function(){}))},e.exports=i()}(S={exports:{}}),S.exports),T="_TEA_VE_OPEN",A="_TEA_VE_APIHOST",D="lang",C="_VISUAL_EDITOR_V",x="_VISUAL_EDITOR_U";function O(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||k.get(D),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||k.get(A),i=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||k.get(C),n=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||k.get(x),o=+new Date,a=new Date(o+18e5);k.set(T,"1",{expires:a}),k.set(A,t,{expires:a}),k.set(x,n,{expires:a}),k.set(D,e,{expires:a}),k.set(C,i||"",{expires:a})}catch(e){}}var M=a("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21"),G=(a("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21"),a("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21"),a("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1c")),I=(a("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20"),!1);function R(e){var t=e.event,i=e.editorUrl,n=e.autoTrackInstance;I||(I=!0,function(e,t,i){var n=document.createElement("script");n.src=e,n.onerror=function(){i(e)},n.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(n)}(i,(function(){b(t,"editorScriptloadSuccess"),n.destroy()}),(function(){t&&b(t,"editorScriptloadError"),I=!1})))}function N(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{};var i="",n=M+"?query="+Date.now();window.TEAVisualEditor.appId=t.app_id;var o=t.channel_domain,a="";if(function(e){e.length&&e.forEach((function(e){y.push(e)}))}(["*"]),o){var r,s="";try{var c=window.performance.getEntriesByType("resource");if(c&&c.length&&(c.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(s=e.name)})),s&&(r=s.split("/"))&&r.length)){a="https:/";for(var l=2;l<r.length&&l!==r.length-1;l++)a=a+"/"+r[l];if(a&&a.indexOf("/5.0")){var h=a.split("/5.0");a=h[0]||a}}}catch(e){}}if(function(e,t){var i={};if(Object.keys(e).length)for(var n in e){if("filter"===n||"autotrack"===n||"enable_stay_duration"===n)break;i[n]=e[n]}(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:i,version:"5.1.13"},"*"),window.addEventListener("message",w,!1)}(t),"1"===k.get(T)){var u=function(){var e=k.get(A);try{e=JSON.parse(e)}catch(e){}return e}(),p="";u&&(window.TEAVisualEditor.__editor_ajax_domain=u,p=k.get(x)),R({event:null,editorUrl:p||n,autoTrackInstance:e}),O()}else try{E("tea:openVisualEditor",(function(t){var r=t.data;if("string"==typeof t.data)try{r=JSON.parse(t.data)}catch(e){r=void 0}if(r){var s=r.referrer,c=r.lang;if(s&&(window.TEAVisualEditor.__editor_ajax_domain=s),i=n,o){var l=r.version;i=a?a+(l?"/visual-editor-rangers-v"+l:"/visual-editor-rangers-v1.0.0")+".js":n,window.TEAVisualEditor.__editor_verison=l}window.TEAVisualEditor.__editor_url=i,window.TEAVisualEditor.lang=c,R({event:t,editorUrl:i,autoTrackInstance:e}),O()}})),window.TEAVisualEditor.openAutotrackEditor=function(){R({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(e){}try{E("tea:openHeatMapCore",(function(i){var n=G,o=i.data.app_id;o&&o!==t.app_id||R({event:i,editorUrl:n+".js?query="+Date.now(),autoTrackInstance:e})}))}catch(e){}}var B=function(){function e(e){this._instance=null,this._intersection=e,this.init()}return e.prototype.init=function(){var e=this;if(window.MutationObserver)try{this._instance=new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&e.attributeChangeObserve(t),"childList"===t.type&&e.modifyNodeObserve(t)}))})),this._instance.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})}catch(e){}},e.prototype.attributeChangeObserve=function(e){e.target.hasAttribute("data-exposure")?this.exposureAdd(e,"mutation"):this.exposureRemove(e)},e.prototype.modifyNodeObserve=function(e){var t=this;Array.from(e.addedNodes).forEach((function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureAdd(e,"intersect"),t.mapChild(e,t.exposureAdd.bind(t))})),Array.prototype.forEach.call(e.removedNodes,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureRemove(e),t.mapChild(e,t.exposureRemove.bind(t))}))},e.prototype.mapChild=function(e,t){var i=this;1===e.nodeType&&e.children.length&&Array.prototype.forEach.call(e.children,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t(e),i.mapChild(e,t)}))},e.prototype.exposureAdd=function(e,t){this._intersection&&this._intersection.exposureAdd(e,t)},e.prototype.exposureRemove=function(e){this._intersection&&this._intersection.exposureRemove(e)},e._exposure_observer=null,e}(),j=function(){function e(t,i){this.count=1,this.instance=this.buildObserver(),this.observeMap=e._observer_map,t.autotrack.exposure.ratio?this.Ratio=t.autotrack.exposure.ratio:0===t.autotrack.exposure.ratio?this.Ratio=0:this.Ratio=.5,this.EventHandle=i}return e.prototype.buildObserver=function(){var t=this;if(!e._observer_instance)return IntersectionObserver&&(e._observer_instance=new IntersectionObserver((function(e){e.forEach((function(e){t.observeMap.get(e.target._observeId)&&t.exposureEvent(e)}))}),{threshold:[.01,.25,.5,.75,1]})),e._observer_instance},e.prototype.exposureAdd=function(e,t){var i=e;"mutation"===t&&(i=e.target);var n=i._observeId;if(n||this.observeMap.has(n)){if(!1===i.visible){var o=i.getBoundingClientRect(),a=o.top,r=o.left,s=o.right,c=o.bottom;a>=0&&c<=window.innerHeight&&r>=0&&s<=window.innerWidth&&(i.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e))}}else i._observeId=this.count,i.visible=!1,this.observeMap.set(this.count,i),this.observe(i),this.count++},e.prototype.exposureRemove=function(e){this.observeMap.has(e._observeId)&&(this.observeMap.delete(e._observeId),this.unobserve(e))},e.prototype.exposureEvent=function(e){if(e.intersectionRatio>=this.Ratio&&e.isIntersecting){if("0"===e.target.style.opacity||"hidden"===e.target.style.visibility)return;if(!0===e.target.visible)return;e.target.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e)}else e.target.visible=!1},e.prototype.observe=function(e){this.instance.observe(e)},e.prototype.unobserve=function(e){this.instance.unobserve(e)},e._observer_instance=null,e._observer_map=new Map,e}(),P=function(){function e(e,t){e.autotrack&&e.autotrack.exposure&&(this._intersection=new j(e,t),this._observer=new B(this._intersection),this.initObserver())}return e.prototype.initObserver=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),(function(t){e._intersection.exposureAdd(t,"intersect")}))},e}(),U={hashTag:!1,impr:!1};t.a=function(){function e(){}return e.prototype.apply=function(e,t){if(this.autoTrackStart=!1,this.collect=e,this.config=t,t.autotrack){var i=e.Types;t.autotrack&&t.autotrack.collect_url&&!t.autotrack.collect_url()||(this.ready(i.Autotrack),this.collect.emit(i.AutotrackReady))}},e.prototype.ready=function(e){this.collect.set(e);var t=this.config.autotrack;t="object"==typeof t?t:{},t=Object.assign(U,t),this.destroyed=!1,this.options=t,this.Config=new f(d,this.options),this.Exposure=new P(this.config,this.handle.bind(this)),this.Listener=new p(t,this.collect,this.Config),this.EventHandle=new v(this.config,t),this.Request=new _(this.collect),this.autoTrackStart=!0,this.init(),N(this,this.config)},e.prototype.init=function(){this.Listener.init(this.handle.bind(this));try{"base"===this.collect.loadType&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var i=e.eventName;if("click"===i||"exposure"===i||"change"===i||"submit"===i){var n=this.EventHandle.handleEvent(t,i);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},n)}else if("page_view"===i||"page_statistics"===i){var o;o="page_view"===i?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},o)}else if("beat"===i){var a=this.EventHandle.handleBeadtEvent(t),r=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:r},a)}}catch(e){}},e.prototype.destroy=function(){this.autoTrackStart&&(this.autoTrackStart=!1,this.Listener.removeListener())},e}()}}]);
//# sourceMappingURL=collect.9c3f3aed.js.map